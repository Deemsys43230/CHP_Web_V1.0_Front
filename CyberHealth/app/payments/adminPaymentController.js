var adminApp=angular.module("adminApp",["ngRoute","oc.lazyLoad","requestModule","flash","ngAnimate","angularUtils.directives.dirPagination","ui.bootstrap"]);adminApp.controller("AdminPaymentController",function(a,t,o,e){a.totalEarningsByAdmin=0,a.totalEarningsByCoach=0,a.loaddisable=!1,a.currentPage=1,a.doGetCoursePaymentDetails=function(){a.loaded=!0,a.offset=(a.currentPage-1)*a.itemsPerPage,a.limit=a.currentPage*a.itemsPerPage,a.courseSearch||(a.courseSearch=""),a.params={limit:a.limit,offset:a.offset,searchname:a.courseSearch,sortid:a.sortId,sorttype:a.sorttype},t.postRequest("admin/publishedCoursePaymentlist/",a.params).then(function(t){a.courses=[],a.courses=t.data.courselist,a.total_count=t.data.totalrecordcount,a.loaded=!1})},a.doGetCourseSubsciberList=function(){a.offset=(a.currentPage-1)*a.itemsPerPage,a.limit=a.currentPage*a.itemsPerPage,a.loaded=!0,void 0==a.courseSearch&&(a.courseSearch=""),a.params={courseid:e.id,limit:a.limit,offset:a.offset,searchname:a.courseSearch,sortid:a.sortId,sorttype:a.sorttype},t.postRequest("admin/paymentHistoryforCourse/",a.params).then(function(t){a.coursesPaymentHistory=[],a.coachid=t.data.coursePaylist.coachid,a.coursesPaymentHistory=t.data.coursePaylist.paymentHistory,a.courseDetails=t.data.coursePaylist,a.total_count=t.data.totalrecordcount,a.loaded=!1})},a.doGetCoachList=function(){a.loaded=!0,t.getRequest("admin/coachListPayment/","").then(function(t){a.coachList=t.data.CoachList,a.loaded=!1,a.paginationLoad=!0})},a.doGetCoachSubscribersList=function(){a.offset=(a.currentPage-1)*a.itemsPerPage,a.limit=a.currentPage*a.itemsPerPage,a.loaded=!0,void 0==a.subscriberSearch&&(a.subscriberSearch=""),a.params={coachid:e.id,limit:a.limit,offset:a.offset,searchname:a.subscriberSearch,sortid:a.sortId,sorttype:a.sorttype},t.postRequest("admin/paymentHistoryforCoach/",a.params).then(function(t){a.coachPaymentHistory=[],a.coachPaymentHistory=t.data.coachPaylist,a.coachid=t.data.coachPaylist.coachid,a.total_count=t.data.totalrecordcount,a.loaded=!1})},a.doGetSubscriberDetailView=function(){a.loaded=!0,t.postRequest("admin/detailViewofCourseTransactionbyAdmin/",{paymentid:e.id}).then(function(t){a.coursePurchaseDetailView=t.data.course_purchase_detail,a.loaded=!1})},a.doGetCoachSubscriberDetailView=function(){a.loaded=!0,t.postRequest("admin/detailViewofsubscriptionTransactionbyAdmin/",{paymentid:e.id}).then(function(t){a.coachSubscriptionDetailView=t.data.subscription_transaction_detail,a.loaded=!1})},a.doGetCoursePuchaseDetails=function(){t.postRequest("courseDetail/",{courseid:e.id}).then(function(t){a.coursePurchsedDeatils=t.data.coursedetail})},a.sortingCourse=function(t){a.sortId=t,a.currentPage=1;var o=a.sortIcon[t];a.sortIcon=["fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down"],"fa fa-caret-down"==o?(a.sortIcon[t]="fa fa-caret-up",a.sorttype=2):(a.sortIcon[t]="fa fa-caret-down",a.sorttype=1),a.doGetCoursePaymentDetails()},a.sortingCourseSubscriber=function(t){a.sortId=t,a.currentPage=1;var o=a.sortIcon[t];a.sortIcon=["fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down"],"fa fa-caret-down"==o?(a.sortIcon[t]="fa fa-caret-up",a.sorttype=2):(a.sortIcon[t]="fa fa-caret-down",a.sorttype=1),a.doGetCourseSubsciberList()},a.sortingCoachSubscriber=function(t){a.sortId=t,a.currentPage=1;var o=a.sortIcon[t];a.sortIcon=["fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down"],"fa fa-caret-down"==o?(a.sortIcon[t]="fa fa-caret-up",a.sorttype=2):(a.sortIcon[t]="fa fa-caret-down",a.sorttype=1),a.doGetCoachSubscribersList()},a.totalEarnbycourse=function(){t.getRequest("admin/totalShareByCourse/","").then(function(t){a.totalEarningsByAdmin=t.data.totalearningsAdmin,a.totalEarningsByCoach=t.data.totalearningsCoach})},a.totalEarnByCourseId=function(){t.postRequest("admin/adminandcoachsharebyCourseid/",{courseid:e.id}).then(function(t){a.totalEarningsByAdmin=t.data.totalearningsAdmin,a.totalEarningsByCoach=t.data.totalearningsCoach})},a.totalEarnByCoaches=function(){t.getRequest("admin/totalShareByCoach/","").then(function(t){a.totalEarningsByAdmin=t.data.totalearningsAdmin,a.totalEarningsByCoach=t.data.totalearningsCoach})},a.totalEarnByCoachId=function(){t.postRequest("admin/adminandcoachsharebyCoachid/",{coachid:e.id}).then(function(t){a.totalEarningsByAdmin=t.data.totalearningsAdmin,a.totalEarningsByCoach=t.data.totalearningsCoach})},a.coachSortIcons={coachname:"fa fa-caret-down",coachsubscriptioncount:"fa fa-caret-down",coachonemonthpay:"fa fa-caret-down",toatlearningsCoach:"fa fa-caret-down",totalearningsAdmin:"fa fa-caret-down"},a.sortBy=function(t){a.sortKey=t,a.reverse=!a.reverse;var o=a.coachSortIcons[t];a.coachSortIcons={coachname:"fa fa-caret-down",coachsubscriptioncount:"fa fa-caret-down",coachonemonthpay:"fa fa-caret-down",toatlearningsCoach:"fa fa-caret-down",totalearningsAdmin:"fa fa-caret-down"},"fa fa-caret-down"==o?a.coachSortIcons[t]="fa fa-caret-up":a.coachSortIcons[t]="fa fa-caret-down"},a.init=function(){a.itemsPerPage=10,a.courseSearch="",a.sortId="",a.sorttype="",a.sortIcon=["fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down"],a.doGetCoursePaymentDetails(),a.totalEarnbycourse()},a.subscribersListInit=function(){a.itemsPerPage=6,a.courseSearch="",a.sortId="",a.sorttype="",a.sortIcon=["fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down"],a.doGetCourseSubsciberList(),a.totalEarnByCourseId()},a.coachListInit=function(){a.paginationLoad=!1,a.doGetCoachList(),a.totalEarnByCoaches()},a.coachSubscribersListInit=function(){a.itemsPerPage=1,a.subscriberSearch="",a.sortId="",a.sorttype="",a.sortIcon=["fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down","fa fa-caret-down"],a.doGetCoachSubscribersList(),a.totalEarnByCoachId()},a.subscribersDetailInit=function(){a.doGetSubscriberDetailView()},a.coachSubscribersDetailInit=function(){a.doGetCoachSubscriberDetailView()},a.doManualPay=function(e,r){a.loaddisable=!0,a.loaded=!0,t.postRequest("admin/payManualImplicit/",{coachid:r,paymentid:e}).then(function(t){1==t.data.Response_status?(a.subscribersListInit(),successMessage(o,"Payment successfull"),a.loaded=!1,a.loaddisable=!1):0==t.data.Response_status&&($(function(){$("#lean_overlay").fadeTo(1e3),$("#errormodal").fadeIn(600),$(".common_model").show()}),a.errormsg=t.data.Error,$(".modal_close").click(function(){$(".common_model").hide(),$("#errormodal").hide(),$("#lean_overlay").hide()}),$("#lean_overlay").click(function(){$(".common_model").hide(),$("#errormodal").hide(),$("#lean_overlay").hide()}),a.loaded=!1,a.loaddisable=!1)})}}),adminApp.filter("trusted",["$sce",function(a){return function(t){return a.trustAsResourceUrl(t)}}]),adminApp.filter("html",["$sce",function(a){return function(t){return a.trustAsHtml(t)}}]),adminApp.filter("startsWithLetterFood",function(){return function(a,t){var o=[],e=new RegExp(t,"i");if(a)for(var r=0;r<a.length;r++){var n=a[r];e.test(n.coachname)&&o.push(n)}else;return o}});
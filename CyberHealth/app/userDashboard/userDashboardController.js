function slidemenu(){$("#sidemenu a").on("click",function(a){if(a.preventDefault(),$(this).hasClass("open"));else{var b=$("#sidemenu a.open").attr("href"),c=$(this).attr("href");$(b).fadeOut("fast",function(){$(c).fadeIn().removeClass("hidden"),$(b).addClass("hidden")}),$("#sidemenu a").removeClass("open"),$(this).addClass("open")}})}function daterangepicker(){$("#main-date").click();var a={maxDate:new Date,endDate:new Date,opens:"left",singleDatePicker:!0};$("#main-date").daterangepicker(a,function(a,b,c){angular.element(document.getElementById("main-date")).scope().initialLoadFoodAndExercise(a.format("DD/MM/YYYY")),document.getElementById("main-start-date").value=a.format("DD/MM/YYYY")}),$("#history-graph").click(),$("#history-view").click();var a={maxDate:new Date,startDate:new Date,endDate:new Date,singleDatePicker:!1,opens:"left",showDropdowns:!0,dateLimit:{days:31},ranges:{"Last Week":[moment().subtract(6,"days"),moment()]}};$("#history-graph").daterangepicker(a,function(a,b,c){document.getElementById("history-start").value=a.format("DD/MM/YYYY"),document.getElementById("history-end").value=b.format("DD/MM/YYYY")}),$("#history-view").daterangepicker(a,function(a,b,c){document.getElementById("history-start").value=a.format("DD/MM/YYYY"),document.getElementById("history-end").value=b.format("DD/MM/YYYY")}),$("#history-graph-date").click();var a={maxDate:new Date,startDate:new Date,endDate:new Date,singleDatePicker:!1,opens:"left",showDropdowns:!0,dateLimit:{days:31},ranges:{"Last Week":[moment().subtract(6,"days"),moment()],"Last 2 Weeks":[moment().subtract(13,"days"),moment()],"Last 3 Weeks":[moment().subtract(20,"days"),moment()],"This Month":[moment().subtract(0,"month").startOf("month"),moment()],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]}};$("#history-graph-date").daterangepicker(a,function(a,b,c){document.getElementById("history-start").value=a.format("DD/MM/YYYY"),document.getElementById("history-end").value=b.format("DD/MM/YYYY")}),$("#weight-log-date1").click();var a={drops:"down",opens:"left",maxDate:new Date,singleDatePicker:!0};$("#weight-log-date1").daterangepicker(a,function(a,b,c){document.getElementById("weightLogDate1").value=a.format("DD/MM/YYYY");var d=angular.element($("#weight-log-date1")).scope();d.doGetWeightLog(a.format("DD/MM/YYYY"),2)})}function modeltrigger(){$("#modal_trigger_food").leanModal({top:200,overlay:.6,closeButton:".modal_close"}),$(function(){$(".common_model").show()}),$("#modal_trigger_exercise").leanModal({top:200,overlay:.6,closeButton:".modal_close"}),$(function(){$(".common_model").show()}),$("#weight_button").click(function(){"0px"==$("#weight-form").css("right")?($("#update-weight-form").slideToggle(800),$("#weight-form").animate({right:"-300px"},500)):($("#weight-form").animate({right:"0px"},500),$("#update-weight-form").slideToggle(300))})}function tabcontent(){$(".tab_content").show(),$("ul.session li").click(function(){$("ul.session li").removeClass("active"),$(this).addClass("active")}),$(".tab_content").show(),$("ul.graphs li").click(function(){$("ul.graphs li").removeClass("active"),$(this).addClass("active")})}function mouseover(a){a.setAttribute("scrollamount",0,0),a.stop()}function mouseout(a){a.setAttribute("scrollamount",3,0),a.start()}function coachAdviceCarousel(){setTimeout(function(){$(".advice-carousel").each(function(){var a,b,c,d,e=jQuery(this),f=$(this).attr("data-appeared-items"),g=$(this).attr("data-navigation");a="false"!=g&&"0"!=g,1==f?(b=1,c=1,d=1):f>=2&&f<4?(b=f,c=f-1,d=f-1):f>=4&&f<8?(b=f-1,c=f-2,d=f-3):(b=f-3,c=f-6,d=f-8),e.owlCarousel({slideSpeed:300,stopOnHover:!0,autoPlay:!1,navigation:a,pagination:!1,lazyLoad:!0,items:f,itemsDesktop:[1e3,b],itemsDesktopSmall:[900,c],itemsTablet:[600,d],itemsMobile:!1,transitionStyle:"goDown"})});var a=$(".advice-carousel-style");a.find(".owl-prev").html('<i class="fa fa-angle-left"></i>'),a.find(".owl-next").html('<i class="fa fa-angle-right"></i>')},500)}var userApp=angular.module("userApp",["ngRoute","oc.lazyLoad","ngCookies","requestModule","flash","ngAnimate","ngTouch","ngPercentDisplay","userDashboardServiceModule","angular-svg-round-progress","ui.bootstrap","angular-nicescroll"]);userApp.controller("UserDashboardController",["$scope","$window","requestHandler","Flash","UserDashboardService","$interval","roundProgressService","limitToFilter","$timeout","$compile","$location","$rootScope","$route",function(a,b,c,d,e,f,g,h,j,k,l,m,n){a.foodSearchResult=[],a.userFood={},a.userFood.sessionid=1,a.graphSessionId="1",a.servings=0,a.current=a.caloriesIntake=0,a.max=a.gainGraphMax=100,a.exerciseSearchResult=[],a.userExercise={},a.customExercise={},a.exercisename="",a.reps="",a.calories="",a.caloriesSpent=0,a.workoutvalue=0,a.workoutvalueMinutes=0,a.workoutvalueSeconds=0,a.workoutvalueHours=0,a.selectedMinutes=0,a.selectedSeconds=0,a.selectedHours=0,b.singlePicker=!1,b.minimumDate=new Date,a.weightUpdateText="Update",a.syncBtnTxt="Sync Now",a.connectDevice=!1,a.waterAddText="+ Add",a.waterReduceText="- Reduce",a.wearableText="Disconnect",a.graphs=1,a.historyReport=0,a.historyType=1,a.showExercise=0,slidemenu(),daterangepicker(),modeltrigger(),tabcontent(),n.current.$$route.fromGoal&&$("#updateWeightGoal").click(),n.current.$$route.fromDevice&&$("#appAndDevice").click(),a.doUserAddFood=function(){$(function(){$("#lean_overlay").fadeTo(1e3),$("#modal-add-food").fadeIn(600),$(".user_register").show()}),$(".modal_close").click(function(){$(".user_register").hide(),$("#modal-add-food").hide(),$("#lean_overlay").hide(),a.resetdata()}),$("#lean_overlay").click(function(){$(".user_register").hide(),$("#modal-add-food").hide(),$("#lean_overlay").hide(),a.resetdata()}),a.selectedFood=""},a.doUserAddExercise=function(){$(function(){$("#lean_overlay").fadeTo(1e3),$("#modal-add-exercise").fadeIn(600),$(".user_register").show()}),$(".modal_close").click(function(){$(".user_register").hide(),$("#modal-add-exercise").hide(),$("#lean_overlay").hide(),a.resetexercisedata()}),$("#lean_overlay").click(function(){$(".user_register").hide(),$("#modal-add-exercise").hide(),$("#lean_overlay").hide(),a.resetexercisedata()}),a.selectedExercise=""},a.doUserAddCustomExercise=function(){$(function(){$("#lean_overlay").fadeTo(1e3),$("#modal-custom-exercise").fadeIn(600),$(".user_register").show()}),$(".modal_close").click(function(){$(".user_register").hide(),$("#modal-custom-exercise").hide(),$("#lean_overlay").hide(),a.resetexercisedata()}),$("#lean_overlay").click(function(){$(".user_register").hide(),$("#modal-custom-exercise").hide(),$("#lean_overlay").hide(),a.resetexercisedata()})},a.doSyncDevices=function(){a.connectDevice=!0,a.syncBtnTxt="Synchronizing...";var b=document.getElementById("main-start-date").value;c.postRequest("user/syncWearableData/",{date:b}).then(function(b){l.path("dashboard"),a.connectDevice=!1,a.syncBtnTxt="Sync Now"},function(){errorMessage(d,"Please try again later!")})},a.frequentFood=function(b){a.isNew=!0,a.title="Add Food",a.loaded=!0;var c=e.doGetSelectedFoodDetails(b);c.then(function(b){a.userSelectedFoodDetails=b,a.loaded=!1,a.doUserAddFood()})},a.suggestedFoodByAdmin=function(b){a.isNew=!0,a.title="Add Food",a.loaded=!0;var c=e.doGetSelectedFoodDetails(b);c.then(function(b){a.userSelectedFoodDetails=b,a.loaded=!1,a.doUserAddFood()})},a.foodSelected=function(){a.isNew=!0,a.title="Add Food";var b=e.doGetSelectedFoodDetails(a.selectedFood.foodid);b.then(function(b){a.userSelectedFoodDetails=b,a.doUserAddFood()})};var o="",p="";a.doEditUserFood=function(b,c){a.isNew=!1,a.title="Edit Food",a.loaded=!0;var d=e.doGetSelectedFoodDetails(b);d.then(function(b){a.userSelectedFoodDetails=b;var d=e.doGetUserFoodDetails(c);d.then(function(b){a.userFood.userfoodid=b.userfoodid,a.userFood.foodid=b.foodid,$.each(a.userSelectedFoodDetails.measureid,function(c,d){d.measureid==b.measureid.measureid&&(a.userFood.measure=d,o=angular.copy(d))}),a.userFood.servings=parseFloat(b.measureid.servings),p=angular.copy(b.measureid.servings),a.current=a.caloriesIntake=b.measureid.calories,a.current=a.current.toFixed(2),a.current.length-3>2?a.max=100+100*String(0|a.current).slice(0,-2):a.max=100,a.loaded=!1,a.doUserAddFood()})})},a.isCleanFood=function(){return angular.equals(o,a.userFood.measure)&&angular.equals(p,a.userFood.servings)},a.doCalculateCalories=function(){0==a.userFood.servings&&(a.current=a.caloriesIntake=0),!a.userFood.servings>0?a.current=a.caloriesIntake=0:(a.current=a.caloriesIntake=a.userFood.measure.calories*a.userFood.servings,a.current=a.current.toFixed(2),a.current.length-3>2?a.max=100+100*String(0|a.current).slice(0,-2):a.max=100)},a.doInsertUserFood=function(){a.userFood.foodid=a.userSelectedFoodDetails.foodid,a.userFood.measureid=a.userFood.measure.measureid,a.userFood.addeddate=document.getElementById("main-start-date").value,a.userFood.servings=parseFloat(a.userFood.servings);var b=e.doInsertUserFood(a.userFood);b.then(function(){a.loadFoodDiary(a.userFood.addeddate),a.doGetIntakeBruntByDate(a.userFood.addeddate),a.goGetDailyIntakeGraph(a.userFood.addeddate),a.goGetSessionGraph(a.storedSessionId),a.doGetHistoryReport("historyGraph"),a.getBudget(a.userFood.addeddate)})},a.doUpdateUserFood=function(){a.userFood.userfoodid=a.userFood.userfoodid,a.userFood.foodid=a.userFood.foodid,a.userFood.measureid=a.userFood.measure.measureid,a.userFood.servings=parseFloat(a.userFood.servings);var b=e.doUpdateUserFood(a.userFood);b.then(function(){var b=document.getElementById("main-start-date").value;a.loadFoodDiary(b),a.doGetIntakeBruntByDate(b),a.goGetDailyIntakeGraph(b),a.goGetSessionGraph(a.storedSessionId),a.doGetHistoryReport("historyGraph"),a.getBudget(b)})},a.doDeleteUserFood=function(b){a.loaded=!0;var c=e.doDeleteUserFood(b);c.then(function(){var b=document.getElementById("main-start-date").value;a.loadFoodDiary(b),a.doGetIntakeBruntByDate(b),a.goGetDailyIntakeGraph(b),a.goGetSessionGraph(a.storedSessionId),a.doGetHistoryReport("historyGraph"),a.getBudget(b)})},a.loadFoodDiary=function(b){a.loaded=!0;var c=e.getFoodDiary(b);c.then(function(b){a.userFoodDiaryDataAll=b,a.loadSessionDetails(),a.loadSessionFood(),a.loaded=!1})},a.loadSessionDetails=function(){switch(a.suggest={},a.suggest.session=a.userFood.sessionid,c.postRequest("user/getUserFoodSuggestions/",a.suggest).then(function(b){a.adminSuggestedFood={},a.adminSuggestedFood="",a.adminSuggestedFood=b.data.foodSuggestion,document.getElementById("marquee").innerHTML="<marquee class='feedbackslide' behavior='scroll' direction='left' id='marqueeid' onmouseover='mouseover(this);' onmouseout='mouseout(this);' scrollamount='3'><span ng-repeat='suggestedFood in adminSuggestedFood' class='slideFeedback'><a href='' ng-click='suggestedFoodByAdmin(suggestedFood.foodId)'>{{suggestedFood.foodName}}</a></span></marquee>",k(document.getElementById("marquee"))(a)}),parseInt(a.userFood.sessionid)){case 1:a.userFoodDiaryData=a.userFoodDiaryDataAll.BreakFast;break;case 2:a.userFoodDiaryData=a.userFoodDiaryDataAll.Brunch;break;case 3:a.userFoodDiaryData=a.userFoodDiaryDataAll.Lunch;break;case 4:a.userFoodDiaryData=a.userFoodDiaryDataAll.Evening;break;case 5:a.userFoodDiaryData=a.userFoodDiaryDataAll.Dinner}},a.inputChanged=function(b){if(b.length>=3){a.loadingFoods=!0,0==a.foodSearchResult.length&&(a.loadingFoods=!0);var c=e.searchFood(b,a.userFood.sessionid);return c.then(function(b){return a.foodSearchResult=b,a.loadingFoods=!1,a.foodSearchResult})}return $(".dropdown-menu").animate({scrollTop:0},0),{}},a.doGetDemograph=function(){var c=e.doGetDemographyDetails();c.then(function(c){if(a.demography=c,a.userProfile){var d=2;1==a.userProfile.gender&&(d=4),1==a.userProfile.unitPreference?(a.heightCal=a.demography.height/100,a.heightCal=a.heightCal*a.heightCal,a.idealWeight=22*a.heightCal,a.idealWeight=a.idealWeight.toFixed(1),a.demography.weight<a.idealWeight?(a.upweight=1,a.idealWeightlevel=a.demography.weight/a.idealWeight,a.idealWeightlevel=100*a.idealWeightlevel/2,a.balanceweight=a.idealWeight-a.demography.weight,a.balanceweight=a.balanceweight.toFixed(1)):a.demography.weight>a.idealWeight?(a.upweight=0,a.idealWeightlevel=a.idealWeight/a.demography.weight,a.idealWeightlevel=100-100*a.idealWeightlevel/2,a.balanceweight=a.demography.weight-a.idealWeight,a.balanceweight=a.balanceweight.toFixed(1)):(a.upweight=2,a.idealWeightlevel=1,a.idealWeightlevel=100*a.idealWeightlevel/2)):2==a.userProfile.unitPreference&&(a.heightFeet=a.demography.height.toString().split(".")[0],a.heightInches=a.demography.height.toString().split(".")[1],a.heightTotal=12*parseInt(a.heightFeet)+parseInt(a.heightInches),a.heightTotal=2.54*a.heightTotal,a.heightCal=a.heightTotal/100,a.heightCal=a.heightCal*a.heightCal,a.idealWeight=22*a.heightCal,a.idealWeight=a.idealWeight/.4536,a.idealWeight=a.idealWeight.toFixed(1),a.idealWeight=parseFloat(a.idealWeight),a.weightCal=.4536*a.demography.weight,a.weightCal=a.demography.weight.toFixed(2),a.weightCal=parseFloat(a.weightCal),a.weightCal<a.idealWeight?(a.upweight=1,a.idealWeightlevel=a.weightCal/a.idealWeight,a.idealWeightlevel=100*a.idealWeightlevel/2,a.balanceweight=a.idealWeight-a.weightCal,a.balanceweight=a.balanceweight.toFixed(1)):a.weightCal>a.idealWeight?(a.upweight=0,a.idealWeightlevel=a.idealWeight/a.weightCal,a.idealWeightlevel=100-100*a.idealWeightlevel/2,a.balanceweight=a.weightCal-a.idealWeight,a.balanceweight=a.balanceweight.toFixed(1)):(a.upweight=2,a.idealWeightlevel=1,a.idealWeightlevel=100*a.idealWeightlevel/2)),b.idealWeightlevel=a.idealWeightlevel.toFixed(2),a.graph={status:"goal"},setTimeout(viewWeightGraph(),10)}else{var f=e.doGetUserDetails();f.then(function(c){a.userProfile=c,a.userProfileImage=a.userProfile.imageurl+"?decache="+Math.random();var d=2;1==a.userProfile.gender&&(d=4),a.idealWeight=a.demography.height-100-(a.demography.height-150)/d,a.idealWeight=a.idealWeight.toFixed(2),a.demography.weight<a.idealWeight?(a.upweight=1,a.idealWeightlevel=a.demography.weight/a.idealWeight,a.idealWeightlevel=100*a.idealWeightlevel/2,a.balanceweight=a.idealWeight-a.demography.weight,a.balanceweight=a.balanceweight.toFixed(2)):a.demography.weight>a.idealWeight?(a.upweight=0,a.idealWeightlevel=a.idealWeight/a.demography.weight,a.idealWeightlevel=100-100*a.idealWeightlevel/2,a.balanceweight=a.demography.weight-a.idealWeight,a.balanceweight=a.balanceweight.toFixed(2)):(a.upweight=2,a.idealWeightlevel=1,a.idealWeightlevel=100*a.idealWeightlevel/2),b.idealWeightlevel=a.idealWeightlevel.toFixed(2),a.graph={status:"goal"},setTimeout(viewWeightGraph(),10)})}})},a.doGetDemograph();var q=e.doGetFrequentlyAdded();q.then(function(b){a.frequentFoodList=b}),a.isAddFood=!1,a.doAddSuggestFood=function(){c.postRequest("user/searchFoodnamebyUser/",{foodname:a.foodSuggest.foodname}).then(function(b){if(0==b.data.Response_status){var c=e.doAddSuggestedFood(a.foodSuggest);c.then(function(b){a.isAddFood=!0,a.resetdata()},function(){errorMessage(d,"Please try again later!")})}else 1==b.data.Response_status&&(errorMessage(d,"Food&nbsp;already&nbsp;exists"),a.resetdata())})},a.msg=function(){a.isAddFood=!1,a.isAddExercise=!1},a.isAddExercise=!1,a.doAddSuggestExercise=function(){var b=e.doAddSuggestedExercise(a.exerciseSuggest);b.then(function(b){a.isAddExercise=!0,a.resetexercisedata()},function(){errorMessage(d,"Please try again later!")})},a.inputChangedExercise=function(b){if(b.length){a.loadingExercise=!0,0==a.exerciseSearchResult.length&&(a.loadingExercise=!0);var c=e.searchExercise(b,a.selectedCategory,a.selectedType);return c.then(function(b){return a.exerciseSearchResult=b,a.loadingExercise=!1,a.exerciseSearchResult})}},a.frequentExercise=function(b){a.isNew=!0,a.title="Add Exercise",a.loaded=!0;var c=e.doGetSelectedExerciseDetails(b);c.then(function(b){a.userSelectedExerciseDetails=b,a.loaded=!1,a.doUserAddExercise()})},a.suggestedExerciseByAdmin=function(b){a.isNew=!0,a.title="Add Exercise",a.loaded=!0;var c=e.doGetSelectedExerciseDetails(b);c.then(function(b){a.userSelectedExerciseDetails=b,a.loaded=!1,a.doUserAddExercise()})},a.exerciseSelected=function(){a.isNew=!0,a.title="Add Exercise";var b=e.doGetSelectedExerciseDetails(a.selectedExercise.exerciseid);b.then(function(b){a.userSelectedExerciseDetails=b,a.doUserAddExercise()})},a.doFilterPopup=function(){$(function(){$("#lean_overlay").fadeTo(1e3),$("#modal-filter").fadeIn(600),$(".common_model").show(),a.shouldBeOpen=!0}),$(".modal_close").click(function(){$(".common_model").hide(),$("#modal-filter").hide(),$("#lean_overlay").hide(),a.shouldBeOpen=!1}),$("#lean_overlay").click(function(){$(".common_model").hide(),$("#modal-filter").hide(),$("#lean_overlay").hide(),a.shouldBeOpen=!1})},a.selectedCategory=[],a.selectedType=[],a.doGetCategoryandTypeExercise=function(){c.getRequest("user/exercisetypeandcategorylist/","").then(function(b){a.categorylist=b.data.exercisecategory,$.each(a.categorylist,function(a,b){b.isChecked=!1}),a.typelist=b.data.exercisetype,$.each(a.typelist,function(a,b){b.isChecked=!1}),a.categoryAllChecked=function(){$.each(a.categorylist,function(a,b){b.isChecked=!0})},a.categoryAllUnChecked=function(){$.each(a.categorylist,function(a,b){b.isChecked=!1})},a.typeAllChecked=function(){$.each(a.typelist,function(a,b){b.isChecked=!0})},a.typeAllUnChecked=function(){$.each(a.typelist,function(a,b){b.isChecked=!1})},a.doApplyFilter=function(){$.each(a.categorylist,function(b,c){1==c.isChecked&&a.selectedCategory.push(c.categoryid)}),$.each(a.typelist,function(b,c){1==c.isChecked&&a.selectedType.push(c.typeid)})},a.doClearFilter=function(){$.each(a.categorylist,function(b,c){c.isChecked=!1,a.selectedCategory=[]}),$.each(a.typelist,function(b,c){c.isChecked=!1,a.selectedType=[]})}},function(){errorMessage(d,"Please try again later!")})},a.loadExerciseDiary=function(b){a.loaded=!0;var d=e.getExerciseDiary(b);d.then(function(b){a.userExerciseDiaryDataAll=b,a.loaded=!1,$.each(a.userExerciseDiaryDataAll.ExerciseData,function(b,c){a.userExerciseDiaryDataAll.workoutvalueMinutes=Math.round(c.workoutvalue/60%60),a.userExerciseDiaryDataAll.workoutvalueSeconds=Math.round(c.workoutvalue%60),a.userExerciseDiaryDataAll.workoutvalueHours=Math.round(c.workoutvalue/3600)})}),c.getRequest("user/getUserExerciseSuggestions/","").then(function(b){a.adminSuggestedExercise=b.data.exerciseSuggestion})};var r=e.doGetUserExerciseList();r.then(function(b){a.exerciselist=b}),a.doInsertUserExercise=function(){a.userExercise.exerciseid=a.userSelectedExerciseDetails.exerciseid,a.userExercise.date=document.getElementById("main-start-date").value,a.userExercise.levelunitid=a.userExercise.selectedLevel.levelunitid;var b=e.doInsertUserExercise(a.userExercise);b.then(function(){a.loadExerciseDiary(a.userExercise.date),a.doGetIntakeBruntByDate(a.userExercise.date),a.doGetHistoryReport("historyGraph"),a.getBudget(a.userExercise.date)})},a.doDeleteUserExercise=function(b){a.loaded=!0;var c=e.doDeleteUserExercise(b);c.then(function(){var b=document.getElementById("main-start-date").value;a.loadExerciseDiary(b),a.doGetIntakeBruntByDate(b),a.doGetHistoryReport("historyGraph"),a.getBudget(b)})};var s="",t="",u="";a.doEditUserExercise=function(b,c,d){a.isNew=!1,a.title="Edit Exercise",a.loaded=!0;var f=e.doGetSelectedExerciseDetails(b);f.then(function(f){a.userSelectedExerciseDetails=f;var g=e.doGetUserExerciseDetails(c,d);g.then(function(d){a.userExercise.userexercisemapid=c,a.userExercise.exerciseid=b,$.each(a.userSelectedExerciseDetails.levels.levels,function(b,c){c.levelunitid==d.levelunitid&&(a.userExercise.selectedLevel=c,s=angular.copy(c))}),a.userExercise.workoutvalue=d.workoutvalue,a.workoutvalueMinutes=Math.round(d.workoutvalue/60%60),a.workoutvalueSeconds=Math.round(d.workoutvalue%60),a.workoutvalueHours=Math.round(d.workoutvalue/3600),t=parseInt(d.workoutvalue),a.userExercise.reps=parseInt(d.reps),u=parseInt(d.reps),a.current=a.caloriesSpent=d.calories,a.current=a.current.toFixed(2),a.current.length-3>2?a.max=100+100*String(0|a.current).slice(0,-2):a.max=100,a.loaded=!1,a.doUserAddExercise()})})},a.isCleanExercise=function(){return angular.equals(s,a.userExercise.selectedLevel.levelunitid)&&angular.equals(t,a.userExercise.workoutvalue)},a.doUpdateUserExercise=function(){null!=a.userExercise.date&&delete a.userExercise.date,a.userExercise.userexercisemapid=a.userExercise.userexercisemapid,a.userExercise.exerciseid=a.userExercise.exerciseid,a.userExercise.levelunitid=a.userExercise.selectedLevel.levelunitid,a.userExercise.workoutvalue=parseInt(a.userExercise.workoutvalue);var b=e.doUpdateUserExercise(a.userExercise);b.then(function(){var b=document.getElementById("main-start-date").value;a.loadExerciseDiary(b),a.doGetIntakeBruntByDate(b),a.doGetHistoryReport("historyGraph"),a.getBudget(b)})};var v=e.doGetFrequentlyUsedExercise();v.then(function(b){a.frequentExerciseList=b}),a.doCalculateCaloriesExercise=function(){a.userExercise.workoutvalue=parseInt(3600*a.workoutvalueHours)+parseInt(60*a.workoutvalueMinutes)+parseInt(a.workoutvalueSeconds),0==a.userExercise.workoutvalue&&(a.current=a.caloriesSpent=0),!a.userExercise.workoutvalue>0?a.current=a.caloriesSpent=0:(a.current=a.caloriesSpent=a.userExercise.selectedLevel.MET*a.demography.weight*parseFloat(a.userExercise.workoutvalue/3600),a.current=a.current.toFixed(2),a.current.length-3>2?a.max=a.max+100*String(0|a.current).slice(0,-2):a.max=100)},a.doInsertUserCustomExercise=function(){a.customExercise.reps=parseInt(a.customExercise.reps),a.customExercise.date=document.getElementById("main-start-date").value,a.customExercise.workoutvalue=parseInt(3600*a.selectedHours)+parseInt(60*a.selectedMinutes)+parseInt(a.selectedSeconds);var b=e.doInsertUserCustomExercise(a.customExercise);b.then(function(){a.loadExerciseDiary(a.customExercise.date),a.doGetIntakeBruntByDate(a.customExercise.date),a.doGetHistoryReport("historyGraph"),a.getBudget(a.customExercise.date)})},a.doEditUserCustomExercise=function(b,c){a.isNew=!1,a.title="Edit Custom Exercise",a.loaded=!0;var d=e.doGetUserCustomExerciseDetails(b,c);d.then(function(c){a.customExercise.id=b,a.customExercise.exercisename=c.exercisename,a.customExercise.calories=c.calories,a.customExercise.workoutvalue=c.workoutvalue,a.selectedMinutes=Math.round(c.workoutvalue/60%60),a.selectedSeconds=Math.round(c.workoutvalue%60),a.selectedHours=Math.round(c.workoutvalue/3600),t=c.workoutvalue,a.customExercise.reps=parseInt(c.reps),u=parseInt(c.reps),a.loaded=!1,a.doUserAddCustomExercise()})},a.doUpdateUserCustomExercise=function(){null!=a.customExercise.date&&delete a.customExercise.date,a.customExercise.workoutvalue=parseInt(3600*a.selectedHours)+parseInt(60*a.selectedMinutes)+parseInt(a.selectedSeconds),a.customExercise.date=document.getElementById("main-start-date").value,a.customExercise.reps=parseInt(a.customExercise.reps),a.customExercise.calories=a.customExercise.calories.toString(),a.customExercise.workoutvalue=a.customExercise.workoutvalue.toString();var b=e.doUpdateUserCustomExercise(a.customExercise);b.then(function(){var b=document.getElementById("main-start-date").value;a.loadExerciseDiary(b),a.doGetIntakeBruntByDate(b),a.doGetHistoryReport("historyGraph"),a.getBudget(b)})},a.doDeleteUserCustomExercise=function(b,c){a.loaded=!0;var d=e.doDeleteUserCustomExercise(b,c);d.then(function(){var b=document.getElementById("main-start-date").value;a.loadExerciseDiary(b),a.doGetIntakeBruntByDate(b),a.doGetHistoryReport("historyGraph"),a.getBudget(b)})},a.resetdata=function(){a.foodSuggest={},a.foodSuggestForm.$setPristine(),a.userFood.measure="",a.userFood.servings=[],a.FoodAddForm.$setPristine(),a.current=a.caloriesIntake=0,a.max=100,a.userSelectedFoodDetails={}},a.resetexercisedata=function(){a.exerciseSuggest={},a.exerciseSuggestForm.$setPristine(),a.userExercise.selectedLevel="",a.userExercise.repsavailable="",a.userExercise.workoutvalue="",a.workoutvalueMinutes=0,a.workoutvalueSeconds=0,a.workoutvalueHours=0,a.ExerciseAddForm.$setPristine(),a.title="Add Custom Exercise",a.isNew=!0,a.customExercise.reps="",a.customExercise.workoutvalue="",a.selectedHours=0,a.selectedMinutes=0,a.selectedSeconds=0,a.customExercise.exercisename="",a.customExercise.calories="",a.customExerciseAddForm.$setPristine(),a.current=a.caloriesSpent=0,a.max=100,a.userSelectedExerciseDetails={}},a.goal={status:"set-goal"},a.graph={status:"goal"},a.viewGoal=function(){a.doGetWeightGoal(),a.graph={status:"goal"},a.doGetDemograph(),setTimeout(viewWeightGraph(),10)},a.cancelUpdate=function(){a.goal={status:"view-goal"}},a.doGetWeightGoal=function(){a.weightGraph=!0,c.getRequest("getUserId/","").then(function(b){a.userProfile=b.data.User_Profile,a.demographydetail=b.data.demography,a.preferMetric=a.userProfile.unitPreference,a.plantype=a.demographydetail.userPlanType}),c.getRequest("user/getDemography/","").then(function(b){a.demographydata=b.data.Demography_Data,a.weight=a.demographydata.targetweight,a.currentwt=a.demographydata.weight}),c.postRequest("checkGoalStatus/",{date:w}).then(function(b){a.goalPossibilitycheck=b.data.Response_status}),c.getRequest("user/getWeightGoal/","").then(function(c){if(0==c.data.Response_status)a.updateGoal=0,b.singlePicker=!0,b.minimumDate=new Date,a.goal={status:"set-goal"};else if(1==c.data.Response_status)if(a.goalDetails=c.data.Weight_Goal,null==a.goalDetails.goalid)a.updateGoal=0,a.targetText="Period",b.singlePicker=!0,b.minimumDate=new Date;else{a.updateGoal=1;var d,f=a.goalDetails.startdate.slice(6,10)+"-"+a.goalDetails.startdate.slice(3,5)+"-"+a.goalDetails.startdate.slice(0,2),g=w.slice(6,10)+"-"+w.slice(3,5)+"-"+w.slice(0,2),h=a.goalDetails.enddate.slice(6,10)+"-"+a.goalDetails.enddate.slice(3,5)+"-"+a.goalDetails.enddate.slice(0,2);new Date(f).getTime()>new Date(g).getTime()?(d=new Date(f).getTime(),a.viewGraphButton=!1):(d=new Date(g).getTime(),a.viewGraphButton=!0);var i=864e5,j=new Date(h).getTime(),k=j-d;if(a.remainingDates=Math.round(k/i),a.remainingDates<0){a.remainingDates=0,a.goalExpired=1;var l=new Date(f).getTime(),m=j-l;a.targetDays=Math.round(m/i);var n=e.doGetAchievedWeight(a.goalDetails.enddate);n.then(function(b){a.achievedWeight=b;var c=0,d=0,e=0;a.goalDetails.targetweight>a.goalDetails.initialweight?(c=a.goalDetails.targetweight-a.goalDetails.initialweight,d=a.achievedWeight-a.goalDetails.initialweight,d<=0?a.achieveStatus=0:(e=d/c,1==e?a.achieveStatus=2:.6>=e<1&&e<1.4?a.achieveStatus=1:a.achieveStatus=0)):(c=a.goalDetails.initialweight-a.goalDetails.targetweight,d=a.goalDetails.initialweight-a.achievedWeight,d<=0?a.achieveStatus=0:(e=d/c,1==e?a.achieveStatus=2:.6>=e<1&&e<1.4?a.achieveStatus=1:a.achieveStatus=0))})}else a.goalExpired=0;b.currentweight=a.demography.weight,b.targetweight=a.goalDetails.targetweight,b.unit=1==a.userProfile.unitPreference?"Kgs":"Lbs",a.goal={status:"view-goal"}}})},a.setGoal=function(){a.setGoalDetails={},5==a.setGoalDetails.goalchoice&&(""==a.setGoalDetails.enddate?a.setGoalDetails.enddate=w:a.setGoalDetails.enddate=document.getElementById("start").value),a.setGoalDetails.enddate=a.enddate,a.setGoalDetails.currentweight=a.demography.weight,a.setGoalDetails.goalchoice=a.goalchoice,""!=a.demography.weight&&($(function(){$("#lean_overlay").fadeTo(1e3),$("#goal-confirmation").fadeIn(600),$(".common_model").show()}),$(".modal_close").click(function(){$(".common_model").hide(),$("#goal-confirmation").hide(),$("#lean_overlay").hide()}),$("#lean_overlay").click(function(){$(".common_model").hide(),$("#goal-confirmation").hide(),$("#lean_overlay").hide()}))},a.setGoalConfirmation=function(){c.postRequest("user/insertWeightGoal/",a.setGoalDetails).then(function(b){a.doGetWeightGoal(),a.doInsertOrUpdateWeightLog(w,parseFloat(a.setGoalDetails.initialweight))},function(){errorMessage(d,"Please try again later!")})},a.isshowGraph=!1,a.showGraph=function(){a.isshowGraph=!a.isshowGraph},a.doGetWeightLog=function(b,c){var d=e.doGetWeightLogDetails(b);d.then(function(b){var d=b.Weight_logs;d.weight?(a.weightlog=a.originalWeight=d.weight,a.fat=a.originalFat=d.fat,1==c?($("#weightLog").val(d.weight),$("#fatLog").val(d.fat)):($("#weightLog1").val(d.weight),$("#fatLog1").val(d.fat))):(a.originalWeight="",1==c?$("#weightLog").val(""):$("#weightLog1").val(""))})},a.weightLogEntry=function(b){a.weightUpdateText="Updating...",a.spinner=!0,1==b?a.doInsertOrUpdateWeightLog(a.UserDate,parseFloat($("#weightLog").val()),parseFloat($("#fatLog").val())):a.doInsertOrUpdateWeightLog($("#weight-log-date1").val(),parseFloat($("#weightLog1").val()))},a.checkGoalOnLoad=function(b){c.postRequest("checkGoalStatus/",{date:b}).then(function(b){a.budgetCheck=b.data.goalPossiblity})},a.checkGoalStatus=function(b){c.postRequest("checkGoalStatus/",{date:b}).then(function(b){a.budgetCheck=b.data.goalPossiblity,0==a.budgetCheck&&($(function(){$("#lean_overlay").fadeTo(1e3),$("#budgetAlert").fadeIn(600),$(".common_model").show(),a.shouldBeOpen=!0}),$(".modal_close").click(function(){$(".common_model").hide(),$("#budgetAlert").hide(),$("#lean_overlay").hide(),a.shouldBeOpen=!1}),$("#lean_overlay").click(function(){$(".common_model").hide(),$("#budgetAlert").hide(),$("#lean_overlay").hide(),a.shouldBeOpen=!1}))})},a.budgetChangePlan=function(){j(function(){$("#updateWeightGoal").click(),a.updateGoalDetails(a.weight)})},a.doInsertOrUpdateWeightLog=function(e,f,g){c.postRequest("user/weightlogInsertorUpdate/",{date:e,weight:f,fat:a.fat}).then(function(c){e==w&&a.weightGraph&&(b.currentweight=f,b.fat=g),a.spinner=!1,a.weightUpdateText="Update",a.doGetWeightLog(e),a.doGetDemograph(),a.getBudget(e),a.doGetWeightGoal(),a.checkGoalStatus(e)},function(){errorMessage(d,"Please try again later!")})},a.isCleanWeight=function(){return angular.equals(parseFloat($("#weightLog").val()),parseFloat(a.originalWeight))},a.isCleanWeight1=function(){return angular.equals(parseFloat($("#weightLog1").val()),parseFloat(a.originalWeight))},a.doGetWeightLogGraph=function(){a.graph={status:"goal-graph"},1==a.userProfile.unitPreference?a.unit="Kgs":2==a.userProfile.unitPreference&&(a.unit="Lbs");var b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e={},f=[];c.postRequest("user/getWeightLogGraph/",{startdate:a.goalDetails.startdate.toString(),enddate:a.goalDetails.enddate.toString()}).then(function(c){a.weightlogGraph=c.data.Weight_logs;var d=[];$.each(a.weightlogGraph,function(a,c){if(1==c.userentry){var e=[],g=c.date.split("/");e.push(b[g[1]-1]+" "+g[0]),e.push(c.weight),f.push(b[g[1]-1]+" "+g[0]),d.push(e)}}),e.title="Goal Graph",e.name="Weight",e.suffix=" "+a.unit,e.yaxis="Weight ("+a.unit+")",e.xaxis="Number of days",a.drawGoalGraph(d,e,f),a.weightGraphValue=d,a.weightGraph=h(a.weightGraphValue,30)},function(){errorMessage(d,"Please try again later!")})},a.deteteGoal=function(){$(function(){$("#lean_overlay").fadeTo(1e3),$("#goal-delete-confirmation").fadeIn(600),$("#goal-delete-confirmation").fadeIn(600),$(".common_model").show()}),$(".modal_close").click(function(){$(".common_model").hide(),$("#goal-delete-confirmation").hide(),$("#lean_overlay").hide()}),$("#lean_overlay").click(function(){$(".common_model").hide(),$("#goal-delete-confirmation").hide(),$("#lean_overlay").hide()})},a.doAddWeightPopup=function(b){a.choice=b,a.updateWeightForm.$setPristine(),$(function(){$("#lean_overlay").fadeTo(1e3),$("#updateWeight").fadeIn(600),$(".common_model").show(),a.shouldBeOpen=!0}),$(".modal_close").click(function(){$(".common_model").hide(),$("#updateWeight").hide(),$("#lean_overlay").hide(),a.shouldBeOpen=!1}),$("#lean_overlay").click(function(){$(".common_model").hide(),$("#updateWeight").hide(),$("#lean_overlay").hide(),a.shouldBeOpen=!1})},a.docheckGoalEndDate=function(b){a.goalchoice=parseInt(b),5==b?a.goalPossiblityStatus=1:c.postRequest("checkgoalenddate/",{currentweight:a.demography.weight,goalchoice:a.goalchoice}).then(function(b){a.goalPossiblityStatus=b.data.Response_status,a.customResponse=1,1==b.data.Response_status&&(a.enddate=b.data.goalEndDate)})},a.doCheckPossibleDate=function(b){c.postRequest("/user/getWeightLogGraph/",{startdate:a.UserDate,
enddate:a.UserDate}).then(function(c){a.UserWeightEntry=c.data.Weight_logs[0].userentry,0==a.UserWeightEntry?a.doAddWeightPopup(b):a.docheckGoalEndDate(b)})},a.updateWeightLogAndEndDate=function(b){a.updateWeightLog(),a.docheckGoalEndDate(b)},a.updateWeightLog=function(){a.weightlog=parseFloat(a.weightlog),c.postRequest("user/weightlogInsertorUpdate/",{date:a.UserDate,weight:a.weightlog}).then(function(a){},function(){errorMessage(d,"Please try again later!")})},a.doDeleteGoal=function(){c.postRequest("user/deleteWeightGoal/",{date:w,currentweight:a.demography.weight}).then(function(c){a.updateGoal=0,b.goalStartDate=b.goalEndDate=w,b.minimumDate=new Date,a.targetText="Period",b.singlePicker=!0,a.goal={status:"set-goal"}},function(){errorMessage(d,"Please try again later!")})},a.updateGoalDetails=function(c){a.weightGraph=!1,a.goalPossiblityStatus=0,a.targetText="End Date",b.singlePicker=!0,a.originalUpdateGoalWeight={endDate:a.goalDetails.enddate,weight:a.goalDetails.targetweights};var d=a.goalDetails.startdate.slice(6,10)+","+a.goalDetails.startdate.slice(3,5)+","+a.goalDetails.startdate.slice(0,2),e=w.slice(6,10)+","+w.slice(3,5)+","+w.slice(0,2);3==a.goalDetails.planType&&(b.goalStartDate=a.goalDetails.enddate),5==a.goalDetails.planchoice&&(b.goalStartDate=a.goalDetails.startdate,a.goalDetails.enddate!=w?b.goalEndDate=a.goalDetails.enddate:b.goalEndDate=new Date),a.weight=a.goalDetails.targetweight,a.currentEnddate=a.goalDetails.enddate,2==a.goalDetails.planType&&(a.goalchoice=a.goalDetails.planchoice.toString()),a.currentweight=c,new Date(d).getTime()>=new Date(e).getTime()?b.minimumDate=a.goalDetails.startdate:b.minimumDate=new Date,a.goal={status:"set-goal"}},a.setGoalTypeOptions=function(b){var c;2==a.demography.userPlanType?c="Gain":3==a.demography.userPlanType&&(c="Lose"),1==a.userProfile.unitPreference?a.goalTypeOptions=[{value:1,name:c+" 1/4 kg per week"},{value:2,name:c+" 1/2 kg per week"},{value:3,name:c+" 3/4 kg per week"},{value:4,name:c+" 1 kg per week"},{value:5,name:"Custom"}]:a.goalTypeOptions=[{value:1,name:c+" 1/2 lb per week"},{value:2,name:c+" 1 lb per week"},{value:3,name:c+" 1 1/2 lbs per week"},{value:4,name:c+" 2 lbs per week"},{value:5,name:"Custom"}],2==b?a.goalType=a.goalTypeOptions[0]:null==a.goalDetails.planchoice?a.goalType=a.goalTypeOptions[0]:a.goalType=a.goalTypeOptions[a.goalDetails.planchoice-1]},a.isCleanUpdateGoal=function(){var b=document.getElementById("end").value;""==b&&(b=a.goalDetails.enddate);var c={endDate:b,weight:parseFloat(document.getElementById("target").value)};return angular.equals(a.originalUpdateGoalWeight,c)},a.changeGoalType=function(b){a.goalType=b},a.updateGoalAlert=function(){$(function(){$("#lean_overlay").fadeTo(1e3),$("#updateGoalAlert").fadeIn(600),$(".common_model").show()}),$(".modal_close").click(function(){$(".common_model").hide(),$("#updateGoalAlert").hide(),$("#lean_overlay").hide()}),$("#lean_overlay").click(function(){$(".common_model").hide(),$("#updateGoalAlert").hide(),$("#lean_overlay").hide()})},a.updateGoalCheck=function(){2==a.goalDetails.planType?a.demography.weight<a.demography.targetweight?(a.doWeightGoalUpdate="loss",a.updateGoalAlert()):a.doUpdateGoal():3==a.goalDetails.planType&&(a.demography.weight>a.demography.targetweight?(a.doWeightGoalUpdate="gain",a.updateGoalAlert()):a.doUpdateGoal())},a.highlightPlan=function(){m.planHighlight=!0,l.url("/demography")},a.doUpdateGoal=function(){a.setGoalDetails={},a.setGoalDetails.currentweight=a.demography.weight,2==a.goalDetails.planType?(a.setGoalDetails.goalchoice=parseInt(a.goalchoice),5==a.setGoalDetails.goalchoice&&(""==document.getElementById("start").value?a.setGoalDetails.enddate=a.goalDetails.enddate:a.setGoalDetails.enddate=document.getElementById("start").value)):3==a.goalDetails.planType?(a.setGoalDetails.goalchoice="",""==document.getElementById("start1").value?a.setGoalDetails.enddate=a.goalDetails.enddate:a.setGoalDetails.enddate=document.getElementById("start1").value):a.setGoalDetails.enddate=a.enddate,a.userChosenDate=a.setGoalDetails.enddate,c.postRequest("user/weightgoalInsertorUpdate/",a.setGoalDetails).then(function(b){0==b.data.Response_status?(a.customResponse=b.data.Response_status,a.goalPossiblityStatus=0,a.customPossibleDate=b.data.possibledate,a.setGoalDetails.enddate=a.customPossibleDate,$(function(){$("#lean_overlay").fadeTo(1e3),$("#custom-goal-confirmation").fadeIn(600),$(".common_model").show(),a.shouldBeOpen=!0}),$(".modal_close").click(function(){$(".common_model").hide(),$("#custom-goal-confirmation").hide(),$("#lean_overlay").hide(),a.shouldBeOpen=!1}),$("#lean_overlay").click(function(){$(".common_model").hide(),$("#custom-goal-confirmation").hide(),$("#lean_overlay").hide(),a.shouldBeOpen=!1})):(a.doGetWeightGoal(),a.getBudget(w))},function(){errorMessage(d,"Please try again later!")})},a.customGoalClear=function(){a.setGoalDetails.enddate=a.enddate},a.checkCustomGoal=function(){a.setGoalDetails={},a.goalType=a.goalDetails.planType,a.setGoalDetails.currentweight=a.demography.weight,a.setGoalDetails.goalchoice=parseInt(a.goalchoice),2==a.goalType?5==a.setGoalDetails.goalchoice&&0!=a.customResponse?""==document.getElementById("start").value?a.setGoalDetails.enddate=w:a.setGoalDetails.enddate=document.getElementById("start").value:5==a.setGoalDetails.goalchoice&&0==a.customResponse?a.setGoalDetails.enddate=a.customPossibleDate:a.setGoalDetails.enddate=a.enddate:3==a.goalType&&(""==document.getElementById("start1").value?a.setGoalDetails.enddate=w:a.setGoalDetails.enddate=a.customPossibleDate),a.userChosenDate=a.setGoalDetails.enddate,c.postRequest("user/weightgoalInsertorUpdate/",a.setGoalDetails).then(function(b){0==b.data.Response_status?(a.customResponse=b.data.Response_status,a.goalPossiblityStatus=10,a.customPossibleDate=b.data.possibledate,a.setGoalDetails.enddate=a.customPossibleDate):1==b.data.Response_status&&(a.doGetWeightGoal(),a.getBudget(w))},function(){errorMessage(d,"Please try again later!")})},a.goGetDailyIntakeGraph=function(b){c.postRequest("user/dailyCalorieGraph/",{date:b}).then(function(b){a.calorieIntakeGraph=b.data.dailyCalorieGraph,""==a.calorieIntakeGraph.averagefat&&(a.calorieIntakeGraph.averagefat=0),""==a.calorieIntakeGraph.fat&&(a.calorieIntakeGraph.fat=0),""==a.calorieIntakeGraph.averageprotein&&(a.calorieIntakeGraph.averageprotein=0),""==a.calorieIntakeGraph.protein&&(a.calorieIntakeGraph.protein=0),""==a.calorieIntakeGraph.averagefibre&&(a.calorieIntakeGraph.averagefibre=0),""==a.calorieIntakeGraph.fibre&&(a.calorieIntakeGraph.fibre=0),""==a.calorieIntakeGraph.averagecarbo&&(a.calorieIntakeGraph.averagecarbo=0),""==a.calorieIntakeGraph.carbo&&(a.calorieIntakeGraph.carbo=0),$("#dailyIntake").highcharts({title:{text:""},xAxis:{categories:["Protein","Fat","Carbs","Fibre"],labels:{style:{fontSize:"9px",fontWeight:"normal"},useHTML:!0,formatter:function(){return"Protein"==this.value?this.value+'<br/><img class="hidden-md" src="../../images/i-protein.jpg"/>':"Fat"==this.value?"&nbsp;&nbsp;"+this.value+'&nbsp;&nbsp;&nbsp;&nbsp;<br/><img class="hidden-md" src="../../images/i-fats.jpg"/>':"Carbs"==this.value?this.value+'&nbsp;<br/><img class="hidden-md" src="../../images/i-carbs.jpg"/>':"Fibre"==this.value?"&nbsp;"+this.value+'&nbsp;&nbsp;<br/><img class="hidden-md" src="../../images/i-fibre.jpg"/>':this.value}}},tooltip:{enabled:!0,backgroundColor:"rgba(255, 255, 255, 1)",borderWidth:1,shadow:!0,style:{fontSize:"10px",padding:5,zIndex:1e4},formatter:!1},yAxis:{title:{text:null},labels:{style:{fontSize:"10px"}}},exporting:{enabled:!1},credits:{enabled:!1},legend:{enabled:!0,itemStyle:{align:"left"}},plotOptions:{series:{events:{legendItemClick:function(a){var b=this.index,c=this.chart.series;$.each(c,function(a,c){b==a&&(1==c.visible?(c.visible=!1,c.hide()):(c.visible=!0,c.show()))});var d=0;return $.each(c,function(a,b){1==b.visible||d++}),2==d&&$.each(c,function(a,c){b==a&&(1==c.visible?c.hide():c.show())}),!1}}}},series:[{type:"column",name:"Consumed",data:[{name:"Protein",color:"limegreen",y:parseFloat(a.calorieIntakeGraph.protein)},{name:"Fat",color:"red",y:parseFloat(a.calorieIntakeGraph.fat)},{name:"Carbs",color:"orange",y:parseFloat(a.calorieIntakeGraph.carbo)},{name:"Fibre",color:"#ffcc00",y:parseFloat(a.calorieIntakeGraph.fibre)}],visible:!0},{type:"spline",name:"Required",data:[parseFloat(a.calorieIntakeGraph.averageprotein),parseFloat(a.calorieIntakeGraph.averagefat),parseFloat(a.calorieIntakeGraph.averagecarbo),parseFloat(a.calorieIntakeGraph.averagefibre)],visible:!0,marker:{lineWidth:1,lineColor:Highcharts.getOptions().colors[1],fillColor:"white"}}]})},function(){errorMessage(d,"Please try again later!")})},a.graphTwo=function(){a.graphs=2},a.dailyIntake=function(){a.graphs=3},a.loadSessionFood=function(){switch(parseInt(a.graphSessionId)){case 1:a.userSessionFoods=a.userFoodDiaryDataAll.BreakFast;break;case 2:a.userSessionFoods=a.userFoodDiaryDataAll.Brunch;break;case 3:a.userSessionFoods=a.userFoodDiaryDataAll.Lunch;break;case 4:a.userSessionFoods=a.userFoodDiaryDataAll.Evening;break;case 5:a.userSessionFoods=a.userFoodDiaryDataAll.Dinner}a.goGetSessionGraph(a.graphSessionId)},a.goGetSessionGraph=function(b){a.loaded=!0;var e=document.getElementById("main-start-date").value;a.storedSessionId=b,a.storedSessionId&&c.postRequest("user/getDailyCalorieGraphWithSession/",{date:e,sessionid:b}).then(function(b){a.calorieIntakeGraph=b.data.Calorie_Graph,a.graphResponse=b.data.Response_status,""==a.calorieIntakeGraph.fat&&(a.calorieIntakeGraph.fat=0),""==a.calorieIntakeGraph.protein&&(a.calorieIntakeGraph.protein=0),""==a.calorieIntakeGraph.fibre&&(a.calorieIntakeGraph.fibre=0),""==a.calorieIntakeGraph.carbo&&(a.calorieIntakeGraph.carbo=0),a.totalUnits=a.calorieIntakeGraph.fat+a.calorieIntakeGraph.protein+a.calorieIntakeGraph.fibre+a.calorieIntakeGraph.carbo,$("#sessionGraph").highcharts({title:{text:""},xAxis:{categories:["Protein","Fat","Carbs","Fibre"],labels:{useHTML:!0,formatter:function(){return"Protein"==this.value?this.value+'<br/><img src="../../images/i-protein.jpg"/>':"Fat"==this.value?"&nbsp;&nbsp;"+this.value+'&nbsp;&nbsp;&nbsp;&nbsp<br/><img src="../../images/i-fats.jpg"/>':"Carbs"==this.value?this.value+'<br/><img src="../../images/i-carbs.jpg"/>':"Fibre"==this.value?this.value+'&nbsp;&nbsp;<br/><img src="../../images/i-fibre.jpg"/>':this.value}}},tooltip:{enabled:!0,backgroundColor:"rgba(255, 255, 255, 1)",borderWidth:1,shadow:!0,style:{fontSize:"10px",padding:5,zIndex:500},formatter:!1},yAxis:{title:{text:null},min:0,max:a.totalUnits,labels:{style:{fontSize:"10px"}}},exporting:{enabled:!1},credits:{enabled:!1},legend:{enabled:!1},series:[{type:"column",showInLegend:!1,name:"Unit",data:[{name:"Protein",color:"limegreen",y:parseFloat(a.calorieIntakeGraph.protein)},{name:"Fat",color:"red",y:parseFloat(a.calorieIntakeGraph.fat)},{name:"Carbs",color:"orange",y:parseFloat(a.calorieIntakeGraph.carbo)},{name:"Fibre",color:"#ffcc00",y:parseFloat(a.calorieIntakeGraph.fibre)}]}]}),a.loaded=!1},function(){errorMessage(d,"Please try again later!")})},a.doGetCoachAdvices=function(){c.getRequest("user/getCoachAdvicesByUser/","").then(function(b){var d=e.getCoachIndividualDetail(b.data.Coach_Advice),f=[];$.each(d,function(a,b){f.push(b.coachid)}),c.getRequest("user/getmyCoachList/","").then(function(b){a.coachlist=b.data.getmyCoachList,$.each(a.coachlist,function(a,b){if(f.indexOf(b.userid)==-1){var c={};c.coachid=b.userid,c.coachname=b.name,c.coachimage=b.imageurl,c.description="",d.push(c)}});var c=[{coachid:"n1",coachname:""},{coachid:"n2",coachname:""},{coachid:"n3",coachname:""},{coachid:"n4",coachname:""}];if(d.length<3)for(i=d.length;i<3;i++)d.push(c[i]);else d.push(c[0]);a.coachadvice=d,a.usercoachadvicedetails=a.coachadvice[0],coachAdviceCarousel()})},function(){console.log("Please try again later!")})},a.setCoachDeatails=function(b){a.usercoachadvicedetails=b},a.getHistory=function(){a.historyReport=1,""==$("#history-start").val()?a.isHistoryEmpty=1:a.isHistoryEmpty=0},a.getViewGraph=function(){a.historyReport=0,""==$("#history-start").val()?a.isViewGraphEmpty=1:a.isViewGraphEmpty=0},a.getViewGraph1=function(){a.historyReport=0,""==$("#history-start").val()?a.isViewEmpty=1:a.isViewEmpty=0},a.otherThanHistory=function(){a.historyReport=0},a.setHistoryType=function(b,c){a.historyType=b,""==$("#history-start").val()?a.showGraph=1:a.doGetHistoryReport(c)},a.setGraphType=function(b,c){a.historyType=b,""==$("#history-start").val()||a.doGetGraphReport(c)},a.setExcerciseType=function(b,c){a.historyType=b,""==$("#history-start").val()||a.doGetGraph(c)},a.historyGraph=[{graphCategory:"CALORIES GRAPH",graphCategoryId:1,graphs:[{id:1,name:"Calories Gained",imageSrc:"../../images/gain.png"},{id:2,name:"Calories Burnt",imageSrc:"../../images/burnt.png"},{id:5,name:"Budget vs Net Log",imageSrc:"../../images/budget.png"}]},{graphCategory:"EXERCISE GRAPH",graphCategoryId:2,graphs:[{id:3,name:"Exercise Minutes",imageSrc:"../../images/exercise.png"}]},{graphCategory:"DAILY ACTIVITY GRAPH",graphCategoryId:3,graphs:[{id:6,name:"Nutricients Intake",imageSrc:"../../images/FoodNutrition_Icon.png"},{id:10,name:"Floor Graph",imageSrc:"../../images/floor.png"},{id:7,name:"Steps Value",imageSrc:"../../images/step.png"},{id:11,name:"Heart Rate",imageSrc:"../../images/heartpeak.ico"},{id:12,name:"Sleep Rate",imageSrc:"../../images/sleep.jpg"}]},{graphCategory:"BLOOD GLUCOSE GRAPH",graphCategoryId:4,graphs:[{id:8,name:"Blood Glucose",imageSrc:"../../images/blood.png"},{id:9,name:"Blood Oxygen",imageSrc:"../../images/oxygen.png"}]},{graphCategory:"BLOOD PRESSURE GRAPH",graphCategoryId:5,graphs:[{id:13,name:"Blood Pressure",imageSrc:"../../images/bp.png"}]},{graphCategory:"LOG GRAPH",graphCategoryId:6,graphs:[{id:4,name:"Weight Log",imageSrc:"../../images/log.png"},{id:14,name:"Water Level",imageSrc:"../../images/fat.jpg"}]}],a.doGetGraph=function(b){a.isViewEmpty=0,a.loaded=!0;var d,e;""==$("#history-start").val()?d=e=w:(d=$("#history-start").val(),e=$("#history-end").val());var f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],g=[],h=[],i={};3==a.historyType&&c.postRequest("user/getExerciseMinutesUsingDates/",{fromdate:d,todate:e}).then(function(c){a.historyRecord=c.data.ExerciseMinutesUsingDates,$.each(a.historyRecord,function(a,b){var c=[],d=b.date.split("/");c.push(f[d[1]-1]+" "+d[0]),c.push(parseFloat(b.workoutvalue)),h.push(f[d[1]-1]+" "+d[0]),g.push(c)}),i.title="Exercise Minutes Graph ( "+d+" - "+e+" )",i.name="Exercise Minutes",i.suffix=" mints",i.yaxis="Minutes",i.xaxis="Date Range",i.color="blue",a.drawHistoryGraph(g,h,i,b)})},a.doGetGraphReport=function(b){a.isViewGraphEmpty=0,a.loaded=!0;var d,e;""==$("#history-start").val()?d=e=w:(d=$("#history-start").val(),e=$("#history-end").val());var f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],g=[],h=[],i={};1==a.historyType?c.postRequest("user/calorieGraphbyDates/",{fromdate:d,todate:e}).then(function(c){a.historyRecord=c.data.calorieGraphbyDates,$.each(a.historyRecord,function(a,b){var c=[],d=b.date.split("/");c.push(f[d[1]-1]+" "+d[0]),c.push(parseFloat(b.calorie)),h.push(f[d[1]-1]+" "+d[0]),g.push(c)}),i.title="Calories Gained Graph ( "+d+" - "+e+" )",i.name="Calories Gained",i.suffix=" cals",i.yaxis="Calories (cal)",i.xaxis="Date Range",i.color="limegreen",a.drawHistoryGraph(g,h,i,b)}):2==a.historyType&&c.postRequest("user/getCalorieBurntGraphByDates/",{fromdate:d,todate:e}).then(function(c){a.historyRecord=c.data.CalorieBurntGraphbyDates,$.each(a.historyRecord,function(a,b){var c=[],d=b.date.split("/");c.push(f[d[1]-1]+" "+d[0]),c.push(parseFloat(b.calorie)),h.push(f[d[1]-1]+" "+d[0]),g.push(c)}),i.title="Calories Brunt Graph ( "+d+" - "+e+" )",i.name="Calories Burned",i.suffix=" cals",i.yaxis="Calories (cal)",i.xaxis="Date Range",i.color="red",a.drawHistoryGraph(g,h,i,b)})},a.convertMinutesToHours=function(a){var b="";a<0&&(b="-");var c=Math.floor(Math.abs(a)/60);c=(c<10&&c>=0?"0":"")+c;var a=Math.abs(a)%60;return a=(a<10&&a>=0?"0":"")+a,b+c+"hrs "+a+"min"},a.doGetHistoryReport=function(b){a.isHistoryEmpty=0,a.loaded=!0,a.waterGraphs=!1;var d,e;""==$("#history-start").val()?d=e=w:(d=$("#history-start").val(),e=$("#history-end").val());var f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[],q={};1==a.historyType?c.postRequest("user/calorieGraphbyDates/",{fromdate:d,todate:e}).then(function(c){a.historyRecord=c.data.calorieGraphbyDates,$.each(a.historyRecord,function(a,b){var c=[],d=b.date.split("/");c.push(f[d[1]-1]+" "+d[0]),c.push(parseFloat(b.calorie)),p.push(f[d[1]-1]+" "+d[0]),g.push(c)}),q.title="Calories Gained Graph ( "+d+" - "+e+" )",q.graphType="column",q.name="Calories Gained",q.suffix=" cals",q.yaxis="Calories (cal)",q.xaxis="Date Range",q.color="limegreen",a.drawHistoryGraph(g,p,q,b)}):2==a.historyType?c.postRequest("user/getCalorieBurntGraphByDates/",{fromdate:d,todate:e}).then(function(c){a.historyRecord=c.data.CalorieBurntGraphbyDates,$.each(a.historyRecord,function(a,b){var c=[],d=b.date.split("/");c.push(f[d[1]-1]+" "+d[0]),c.push(parseFloat(b.calorie)),p.push(f[d[1]-1]+" "+d[0]),g.push(c)}),q.title="Calories Brunt Graph ( "+d+" - "+e+" )",q.graphType="column",q.name="Calories Burned",q.suffix=" cals",q.yaxis="Calories (cal)",q.xaxis="Date Range",q.color="red",a.drawHistoryGraph(g,p,q,b)}):3==a.historyType?c.postRequest("user/getExerciseMinutesUsingDates/",{fromdate:d,todate:e}).then(function(c){a.historyRecord=c.data.ExerciseMinutesUsingDates,$.each(a.historyRecord,function(a,b){var c=[],d=b.date.split("/");c.push(f[d[1]-1]+" "+d[0]),c.push(parseFloat(b.workoutvalue)),p.push(f[d[1]-1]+" "+d[0]),g.push(c)}),q.title="Exercise Minutes Graph ( "+d+" - "+e+" )",q.graphType="column",q.name="Exercise Minutes",q.suffix=" mints",q.yaxis="Minutes",q.xaxis="Date Range",q.color="blue",a.drawHistoryGraph(g,p,q,b)}):4==a.historyType?(1==a.userProfile.unitPreference?a.unit="Kgs":2==a.userProfile.unitPreference&&(a.unit="Lbs"),c.postRequest("/user/getWeightLogGraph/",{startdate:d,enddate:e}).then(function(c){a.historyRecord=c.data.Weight_logs,$.each(a.historyRecord,function(a,b){if(1==b.userentry){var c=[],d=b.date.split("/");c.push(f[d[1]-1]+" "+d[0]),c.push(parseFloat(b.weight)),p.push(f[d[1]-1]+" "+d[0]),g.push(c)}}),q.title="Weight Log Graph ( "+d+" - "+e+" )",q.graphType="column",q.name="Weight Log",q.suffix=a.unit,q.yaxis="Weight ("+a.unit+")",q.xaxis="Date Range",q.color="#f8ba01",a.drawHistoryGraph(g,p,q,b)})):5==a.historyType?c.postRequest("/user/budgetGraphbyDates/",{startdate:d,enddate:e}).then(function(c){a.historyRecord=c.data.BudgetList,$.each(a.historyRecord,function(a,b){var c=[],d=b.date.split("/");c.push(f[d[1]-1]+" "+d[0]),c.push(parseFloat(b.Budget)),h.push(b.Net),n.push(f[d[1]-1]+" "+d[0]),g.push(c)}),q.title="Budget Vs Net Graph ( "+d+" - "+e+" )",q.graphType="column",q.name="Budget",q.suffix=" cals",q.yaxis="Calories (Cal)",q.xaxis="Date Range",q.color="#ff8000",a.drawHistoryGraphForBudget(g,q,h,n,b)}):6==a.historyType?c.postRequest("user/dailyCalorieGraphForDates/",{startdate:d,enddate:e}).then(function(c){a.historyRecord=c.data.dailyCalorieForDates;var h=0,l=0,m=0,n=0;$.each(a.historyRecord,function(a,b){h=parseFloat(h)+parseFloat(b.fibre),l=parseFloat(l)+b.protein,m=parseFloat(m)+b.fat,n=parseFloat(n)+b.carbo;var c=[],d=b.date.split("/");c.push(f[d[1]-1]+" "+d[0]),c.push(parseFloat(b.protein)),i.push(parseFloat(b.fibre)),j.push(parseFloat(b.fat)),k.push(parseFloat(b.carbo)),o.push(f[d[1]-1]+" "+d[0]),g.push(c)});var p=h/100,r=l/100,s=m/100,t=n/100;q.title="Nutricients Graph( "+d+" - "+e+" )",q.name="Nutricients",q.yaxis="Units (grams)",q.xaxis="Date Range",q.color="#ff8000",a.drawNutrientsGraph(g,q,i,j,k,p,r,s,t,o,b)}):7==a.historyType?c.postRequest("user/getWearableDataGraph/",{startdate:d,enddate:e}).then(function(c){a.historyRecord=c.data.wearable,$.each(a.historyRecord,function(a,b){var c=[],d=b.date.split("/");c.push(f[d[1]-1]+" "+d[0]),c.push(parseFloat(b.steps)),p.push(f[d[1]-1]+" "+d[0]),g.push(c)}),q.title="Steps Graph( "+d+" - "+e+" )",q.graphType="column",q.name="Steps Walked",q.suffix=" steps",q.yaxis="Steps (count)",q.xaxis="Date Range",q.color="#f8ba01",a.drawHistoryGraph(g,p,q,b)}):8==a.historyType?c.postRequest("user/getWearableDataGraph/",{startdate:d,enddate:e}).then(function(c){a.historyRecord=c.data.wearable,$.each(a.historyRecord,function(a,b){var c=[],d=b.date.split("/");c.push(f[d[1]-1]+" "+d[0]),c.push(parseFloat(b.fastingbloodglucose)),m.push(parseFloat(b.randombloodglucose)),p.push(f[d[1]-1]+" "+d[0]),g.push(c)}),q.title="Blood Glucose Graph( "+d+" - "+e+" )",q.name="Glucose level",q.yaxis="Glucose level (mg/dl)",q.xaxis="Date Range",q.color="red",a.drawBloodGlucoseGraph(g,q,m,p,b)}):9==a.historyType?c.postRequest("user/getWearableDataGraph/",{startdate:d,enddate:e}).then(function(c){a.historyRecord=c.data.wearable,$.each(a.historyRecord,function(a,b){var c=[],d=b.date.split("/");c.push(f[d[1]-1]+" "+d[0]),c.push(parseFloat(b.bloodoxygen)),p.push(f[d[1]-1]+" "+d[0]),g.push(c)}),q.title="Blood Oxygen Graph( "+d+" - "+e+" )",q.graphType="spline",q.name="Bloodoxygen Level",q.suffix="  mg/dl",q.yaxis="Bloodoxygen Level (mg/dl)",q.xaxis="Date Range",q.color="#33bbff",a.drawHistoryGraph(g,p,q,b)}):10==a.historyType?c.postRequest("user/getWearableDataGraph/",{startdate:d,enddate:e}).then(function(c){a.historyRecord=c.data.wearable,$.each(a.historyRecord,function(a,b){var c=[],d=b.date.split("/");c.push(f[d[1]-1]+" "+d[0]),c.push(parseFloat(b.floors)),p.push(f[d[1]-1]+" "+d[0]),g.push(c)}),q.title="Floor Graph( "+d+" - "+e+" )",q.graphType="spline",q.name="Floor's Walked",q.suffix="  floor",q.yaxis="Floor (fts)",q.xaxis="Date Range",q.color="brown",a.drawHistoryGraph(g,p,q,b)}):11==a.historyType?c.postRequest("user/getWearableDataGraph/",{startdate:d,enddate:e}).then(function(c){a.historyRecord=c.data.wearable,$.each(a.historyRecord,function(a,b){var c=[],d=b.date.split("/");c.push(f[d[1]-1]+" "+d[0]),c.push(parseFloat(b.restingheartrate)),p.push(f[d[1]-1]+" "+d[0]),g.push(c)}),q.title="Heart Rate Graph( "+d+" - "+e+" )",q.graphType="line",q.name="Heart Rate",q.suffix="  bpm",q.yaxis="Heart Rate (bpm)",q.xaxis="Date Range",q.color="#ff3300",a.drawHistoryGraph(g,p,q,b)}):12==a.historyType?c.postRequest("user/getWearableDataGraph/",{startdate:d,enddate:e}).then(function(c){a.historyRecord=c.data.wearable,$.each(a.historyRecord,function(a,b){var c=[],d=b.date.split("/");c.push(f[d[1]-1]+" "+d[0]),c.push(parseFloat(b.sleep)),p.push(f[d[1]-1]+" "+d[0]),g.push(c)}),q.title="Sleep Rate Graph( "+d+" - "+e+" )",q.graphType="spline",q.name="Sleep",q.suffix="  minutes",q.yaxis="Sleep (minutes)",q.xaxis="Date Range",q.color="#339966",a.drawSleepHistoryGraph(g,p,q,b)}):13==a.historyType?c.postRequest("user/getWearableDataGraph/",{startdate:d,enddate:e}).then(function(c){a.historyRecord=c.data.wearable,$.each(a.historyRecord,function(a,b){var c=[],d=b.date.split("/");c.push(f[d[1]-1]+" "+d[0]),c.push(parseFloat(b.systolic)),l.push(parseFloat(b.diastolic)),p.push(f[d[1]-1]+" "+d[0]),g.push(c)}),q.title="Blood Pressure Graph( "+d+" - "+e+" )",q.name="BloodPressure",q.suffix="  mmHg",q.yaxis="BloodPressure (mmHg)",q.xaxis="Date Range",q.color="#339966",a.drawBpHistoryGraph(g,p,l,q,b)}):14==a.historyType?c.postRequest("user/getWaterLogGraph/",{startdate:d,enddate:e}).then(function(c){a.historyRecord=c.data.Water_logs,$.each(a.historyRecord,function(a,b){var c=[],d=b.date.split("/");c.push(f[d[1]-1]+" "+d[0]),c.push(b.milliliters),p.push(f[d[1]-1]+" "+d[0]),g.push(c)}),q.title="Water Level Graph( "+d+" - "+e+" )",q.graphType="spline",q.name="Water Level",q.suffix="  ml",q.yaxis="Water Level (ml)",q.xaxis="Date Range",q.color="#00ccff",a.drawWaterlogMlHistoryGraph(g,p,q,b)}):15==a.historyType&&c.postRequest("user/getWaterLogGraph/",{startdate:d,enddate:e}).then(function(c){a.historyRecord=c.data.Water_logs,$.each(a.historyRecord,function(a,b){var c=[],d=b.date.split("/");c.push(f[d[1]-1]+" "+d[0]),c.push(b.ounces),p.push(f[d[1]-1]+" "+d[0]),g.push(c)}),q.title="Water Level Graph( "+d+" - "+e+" )",q.graphType="spline",q.name="Water Level",q.suffix="  oz",q.yaxis="Water Level (oz)",q.xaxis="Date Range",q.color="#ff9999",a.drawWaterlogOzHistoryGraph(g,p,q,b)}),a.showGraph=1},a.drawHistoryGraph=function(b,c,d,e){console.log(b),a.loaded=!1,$("#"+e).highcharts({title:{text:d.title},xAxis:{title:{text:d.xaxis},categories:c},tooltip:{enabled:!0,backgroundColor:"rgba(255, 255, 255, 1)",borderWidth:1,shadow:!0,style:{fontSize:"10px",padding:5,zIndex:500},formatter:!1,valueSuffix:d.suffix},yAxis:{title:{text:d.yaxis},plotLines:[{value:0,width:1,color:d.color}]},colors:[d.color],exporting:{enabled:!1},credits:{enabled:!1},legend:{enabled:!1},series:[{type:d.graphType,name:d.name,data:b}]}),$("#excerciseGraph").highcharts({title:{text:d.title},xAxis:{title:{text:d.xaxis},categories:c},tooltip:{enabled:!0,backgroundColor:"rgba(255, 255, 255, 1)",borderWidth:1,shadow:!0,style:{fontSize:"10px",padding:5,zIndex:500},formatter:!1,valueSuffix:d.suffix},yAxis:{title:{text:d.yaxis},plotLines:[{value:0,width:1,color:d.color}]},colors:[d.color],exporting:{enabled:!1},credits:{enabled:!1},legend:{enabled:!1},series:[{type:"column",name:d.name,data:b}]})},a.drawHistoryGraphForBudget=function(b,c,d,e,f){console.log(b),console.log(c),console.log(d),console.log(e),a.loaded=!1,$("#"+f).highcharts({chart:{type:"column"},title:{text:c.title},xAxis:{title:{text:c.xaxis},categories:e},tooltip:{enabled:!0,backgroundColor:"rgba(255, 255, 255, 1)",borderWidth:1,shadow:!0,style:{fontSize:"10px",padding:5,zIndex:500},formatter:!1,valueSuffix:c.suffix},yAxis:{title:{text:c.yaxis},plotLines:[{value:0,width:1,color:c.color}]},colors:[c.color],exporting:{enabled:!1},credits:{enabled:!1},legend:{enabled:!1},series:[{type:"column",name:"Net",data:d},{type:"spline",name:"Budget",data:b,marker:{lineWidth:2,lineColor:Highcharts.getOptions().colors[3],fillColor:"white"}}]})},a.drawNutrientsGraph=function(b,c,d,e,f,g,h,i,j,k,l){console.log(b),a.loaded=!1,$("#"+l).highcharts({chart:{type:"column"},title:{text:c.title},xAxis:{title:{text:c.xaxis},categories:k},yAxis:{min:0,title:{text:c.yaxis},plotLines:[{value:0,width:1,color:c.color}]},colors:[c.color],exporting:{enabled:!1},credits:{enabled:!1},legend:{enabled:!1},tooltip:{enabled:!0,backgroundColor:"rgba(255, 255, 255, 1)",borderWidth:1,shadow:!0,pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.2f} %</b></td></tr>',style:{fontSize:"10px",padding:5,zIndex:500},formatter:!1,valueSuffix:c.suffix},series:[{name:"Protein",color:"limegreen",data:b,tooltip:{headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.2f} g</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0,enabled:!0,backgroundColor:"rgba(255, 255, 255, 1)",borderWidth:1,shadow:!0,style:{fontSize:"10px",padding:5,zIndex:500},formatter:!1}},{name:"Fat",color:"red",data:e,tooltip:{headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.2f} g</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0,enabled:!0,backgroundColor:"rgba(255, 255, 255, 1)",borderWidth:1,shadow:!0,style:{fontSize:"10px",padding:5,zIndex:500},formatter:!1}},{name:"Carbs",color:"#ff8000",data:f,tooltip:{headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.2f} g</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0,enabled:!0,backgroundColor:"rgba(255, 255, 255, 1)",borderWidth:1,shadow:!0,style:{fontSize:"10px",padding:5,zIndex:500},formatter:!1}},{name:"Fibre",color:"#ffcc00",data:d,tooltip:{headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.2f} g</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0,enabled:!0,backgroundColor:"rgba(255, 255, 255, 1)",borderWidth:1,shadow:!0,style:{fontSize:"10px",padding:5,zIndex:500},formatter:!1}},{type:"pie",name:"Total Consumption",data:[{name:"Protein",y:h,color:"limegreen"},{name:"Fat",y:i,color:"red"},{name:"Fibre",y:g,color:"#ffcc00"},{name:"Carbo",y:j,color:"#ff8000"}],center:[100,80],size:100,showInLegend:!1,dataLabels:{enabled:!1}}]})},a.drawSleepHistoryGraph=function(b,c,d,e){console.log(b),a.loaded=!1,$("#"+e).highcharts({title:{text:d.title},xAxis:{title:{text:d.xaxis},categories:c},tooltip:{enabled:!0,backgroundColor:"rgba(255, 255, 255, 1)",borderWidth:1,shadow:!0,style:{fontSize:"10px",padding:5,zIndex:500},formatter:function(){return" <b>"+this.x+"</b>,<br/>Sleep: <b>"+this.y+"</b> mins ("+a.convertMinutesToHours(this.y)+")"},valueSuffix:d.suffix},yAxis:{title:{text:d.yaxis},plotLines:[{value:0,width:1,color:d.color}]},colors:[d.color],exporting:{enabled:!1},credits:{enabled:!1},legend:{enabled:!1},series:[{type:d.graphType,name:d.name,data:b,additional:"true"}]})},a.drawBloodGlucoseGraph=function(b,c,d,e,f){console.log(b),a.loaded=!1,$("#"+f).highcharts({title:{text:c.title},xAxis:{title:{text:c.xaxis},categories:e},yAxis:{min:0,title:{text:c.yaxis},plotLines:[{value:0,width:1,color:c.color}]},colors:[c.color],exporting:{enabled:!1},credits:{enabled:!1},tooltip:{headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.2f} mg/dl</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0,enabled:!0,backgroundColor:"rgba(255, 255, 255, 1)",borderWidth:1,shadow:!0,style:{fontSize:"10px",padding:5,zIndex:500},formatter:!1},plotOptions:{column:{zones:[{value:195,color:"#00cc44"},{value:225,color:"#ffd11a"},{value:400,color:"#e60000"}]}},series:[{type:"column",name:"Fastingbloodglucose",color:"#339966",data:b},{type:"column",name:"Randombloodglucose",color:"#3366cc",data:d}]})},a.drawBpHistoryGraph=function(b,c,d,e,f){console.log(b),a.loaded=!1,$("#"+f).highcharts({chart:{type:"column"},title:{text:e.title},xAxis:{title:{text:e.xaxis},categories:c},yAxis:{min:0,title:{text:e.yaxis},plotLines:[{value:0,width:1,color:e.color}]},colors:[e.color],exporting:{enabled:!1},credits:{enabled:!1},legend:{enabled:!1},tooltip:{headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.2f} mmHg</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0,enabled:!0,backgroundColor:"rgba(255, 255, 255, 1)",borderWidth:1,shadow:!0,style:{fontSize:"10px",padding:5,zIndex:500},formatter:!1},series:[{name:"Systolic Bp",color:"#cc0000",data:b},{name:"Diastolic Bp",color:"#339966",data:d}]})},a.drawWaterlogMlHistoryGraph=function(b,c,d,e){console.log(b),a.historyType=14,a.waterGraphs=!0,a.loaded=!1,$("#"+e).highcharts({title:{text:d.title},xAxis:{title:{text:d.xaxis},categories:c},tooltip:{enabled:!0,backgroundColor:"rgba(255, 255, 255, 1)",borderWidth:1,shadow:!0,style:{fontSize:"10px",padding:5,zIndex:500},formatter:!1,valueSuffix:d.suffix},yAxis:{title:{text:d.yaxis},plotLines:[{value:0,width:1,color:d.color}]},colors:[d.color],exporting:{enabled:!1},credits:{enabled:!1},legend:{enabled:!1},series:[{type:d.graphType,name:d.name,data:b}]})},a.drawWaterlogOzHistoryGraph=function(b,c,d,e){console.log(b),a.historyType=15,a.waterGraphs=!0,a.loaded=!1,$("#"+e).highcharts({title:{text:d.title},xAxis:{title:{text:d.xaxis},categories:c},tooltip:{enabled:!0,backgroundColor:"rgba(255, 255, 255, 1)",borderWidth:1,shadow:!0,style:{fontSize:"10px",padding:5,zIndex:500},formatter:!1,valueSuffix:d.suffix
},yAxis:{title:{text:d.yaxis},plotLines:[{value:0,width:1,color:d.color}]},colors:[d.color],exporting:{enabled:!1},credits:{enabled:!1},legend:{enabled:!1},series:[{type:d.graphType,name:d.name,data:b}]})},userApp.filter("html",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]),userApp.filter("startsWithLetterHistory",function(){return function(a,b){var c=[],d=new RegExp(b,"i");if(a)for(var e=0;e<a.length;e++){var f=a[e];d.test(f.historyType)&&c.push(f)}else;return c}}),a.datePicker=function(){$("#main-date").click()},a.datePickerGraph=function(){$("#history-graph").click(),$("#history-view").click()},a.datePickerHistoryGraph=function(){$("#history-graph-date").click()},a.drawGoalGraph=function(a,b,c){console.log(a),$("#goalGraph").highcharts({title:{text:b.title},xAxis:{title:{text:b.xaxis},categories:c},tooltip:{enabled:!0,backgroundColor:"rgba(255, 255, 255, 1)",borderWidth:1,shadow:!0,style:{fontSize:"10px",padding:5,zIndex:500},formatter:!1,valueSuffix:b.suffix},yAxis:{title:{text:b.yaxis},plotLines:[{value:0,width:1,color:"#f8ba01"}]},colors:["#f8ba01"],exporting:{enabled:!1},credits:{enabled:!1},legend:{enabled:!1},series:[{name:b.name,data:a}]})},a.getUserTimeZone=function(b){c.getRequest("getUserTimeZone/","").then(function(c){a.UserTimeZone=c.data.time,a.UserDate=a.UserTimeZone.slice(0,10),a.selectDate=b,a.UserDate==b?a.disableUpdateWeight=!1:a.disableUpdateWeight=!0})},a.getBudget=function(b){c.postRequest("user/getTotalCalorieDetailForDate/",{date:b}).then(function(b){a.budgetDetails=b.data.BudgetDetail,a.Budget=a.budgetDetails.Budget,a.Net=a.budgetDetails.Net,1==a.budgetDetails.OverorUnderStatus?a.currentGainColour="red":2==a.budgetDetails.OverorUnderStatus&&(a.currentGainColour="limegreen")})},a.waterlog=0,a.doGetWaterLog=function(b,c){var d=e.doGetWaterLogDetails(b);d.then(function(b){var c=b.Water_log;a.waterlog=c.milliliters,a.waterlogoz=c.ounces})},a.doAddOrReduceWatertLog=function(b){0==b?(a.addspin=!0,a.waterAddText="Updating...",1==a.addlogUnit?c.postRequest("user/waterlogInsertorUpdate/",{date:a.UserDate,milliliters:parseInt(a.waterlog)+parseInt(a.addlog),oz:""}).then(function(b){a.addspin=!1,a.waterAddText="+ Add",a.doGetWaterLog(a.UserDate)},function(){errorMessage(d,"Please try again later!")}):c.postRequest("user/waterlogInsertorUpdate/",{date:a.UserDate,milliliters:"",oz:parseInt(a.waterlogoz)+parseInt(a.addlog)}).then(function(b){a.addspin=!1,a.waterAddText="+ Add",a.doGetWaterLog(a.UserDate)},function(){errorMessage(d,"Please try again later!")})):a.waterlog>a.addlog&&(a.reducespin=!0,a.waterReduceText="Updating...",1==a.addlogUnit?c.postRequest("user/waterlogInsertorUpdate/",{date:a.UserDate,milliliters:parseInt(a.waterlog)-parseInt(a.addlog),oz:""}).then(function(b){a.reducespin=!1,a.waterReduceText="- Reduce",a.doGetWaterLog(a.UserDate)},function(){errorMessage(d,"Please try again later!")}):(a.disableForReduce=a.waterlogoz<=a.addlog,c.postRequest("user/waterlogInsertorUpdate/",{date:a.UserDate,milliliters:"",oz:parseInt(a.waterlogoz)-parseInt(a.addlog)}).then(function(b){a.reducespin=!1,a.waterReduceText="- Reduce",a.doGetWaterLog(a.UserDate)},function(){errorMessage(d,"Please try again later!")})))},a.updateWaterLog=function(){a.waterlog=parseFloat(a.waterlog),c.postRequest("user/waterlogInsertorUpdate/",{date:a.UserDate,milliliters:a.waterlog,oz:a.waterlogoz}).then(function(a){},function(){errorMessage(d,"Please try again later!")})},a.$watch("addlog",function(){1==a.addlogUnit?a.waterlog<=a.addlog?a.isReduceEnable=!0:a.isReduceEnable=!1:a.waterlogoz<=a.addlog?a.isReduceEnable=!0:a.isReduceEnable=!1}),a.OpenFitbitWindow=function(d,e){4==e||5==e?a.connectionDeviceAlert(e):(m.vendorid=e,a.loader=!1,a.device=!0,b.open(d+"&state="+c.domainURL()+"/views/devices/index.html?state="+e,"_self"))},a.doGetVendorlist=function(){c.getRequest("getWearableVendorsListByUser","").then(function(b){a.vendorList=b.data.vendorlist,$.each(a.vendorList,function(a,b){0==b.isactive?b.connectionStatus="Connect":b.connectionStatus="Disconnect"})},function(){errorMessage(d,"Please try again later!")})},a.wearableinit=function(){a.doGetVendorlist()},a.isActive=function(a){return 0==a},a.doGetDisonnectDetails=function(d){return a.wearableText="Disconnecting...",a.logid=d,c.postRequest("disconnectUserWearable/",{logid:a.logid}).then(function(c){"Success"==c.data.Response&&(b.location.href="../user/#/connectDevice",a.doGetVendorlist())})},a.connectionDeviceAlert=function(b){4==b?a.appDevice="Android":a.appDevice="iPhone",$(function(){$("#lean_overlay").fadeTo(1e3),$("#connect-using-mobile").fadeIn(600),$(".common_model").show()}),$(".modal_close").click(function(){$(".common_model").hide(),$("#connect-using-mobile").hide(),$("#lean_overlay").hide()}),$("#lean_overlay").click(function(){$(".common_model").hide(),$("#connect-using-mobile").hide(),$("#lean_overlay").hide()})},a.doGetWearableDateByDate=function(b){return c.postRequest("user/getWearableDataForDate/",{date:b}).then(function(b){console.log(b.data.wearable),a.wearable=b.data.wearable})};var w=new Date,x=w.getDate(),y=w.getMonth()+1,z=w.getFullYear();x<10&&(x="0"+x),y<10&&(y="0"+y),w=x+"/"+y+"/"+z,a.weightLogDate=w,a.todayDate=w,a.selectedDate=w,b.goalStartDate=b.goalEndDate=w,a.initialLoadFoodAndExercise=function(b){a.loadFoodDiary(b),a.loadExerciseDiary(b),a.goGetDailyIntakeGraph(b),a.doGetWeightGoal(),a.doGetWeightLog(b),a.doGetWaterLog(b),a.goGetSessionGraph(a.storedSessionId),a.getUserTimeZone(b),a.getBudget(b),a.checkGoalOnLoad(b),a.doGetWearableDateByDate(b)},a.initialLoadFoodAndExercise(w),a.doGetCoachAdvices(),a.Rangem=function(a,b){for(var c=[],d=a;d<=b;d++)c.push(d);return c},a.minutesList=a.Rangem(1,1e3),a.Ranges=function(a,b){for(var c=[],d=a;d<=b;d++)c.push(d);return c},a.secondsList=a.Ranges(1,1e3),a.offset=0,a.timerCurrent=0,a.uploadCurrent=0,a.stroke=12,a.radius=70,a.isSemi=!1,a.rounded=!1,a.responsive=!1,a.clockwise=!0,a.bgColor="#ddd",a.duration=1e3,a.currentAnimation="easeOutCubic",a.animations=[],angular.forEach(g.animations,function(b,c){a.animations.push(c)}),a.getStyle=function(){var b=(a.isSemi?"":"translateY(-50%) ")+"translateX(-50%)";return{top:a.isSemi?"auto":"52%",bottom:a.isSemi?"5%":"auto",left:"50%",transform:b,"-moz-transform":b,"-webkit-transform":b}};a.prevent=function(){event.preventDefault()},a.open=function(b){b.preventDefault(),b.stopPropagation(),a.opened=!0},a.format="dd/MM/yyyy";var A=function(){var a=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,b=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,c=/[^-+\dA-Z]/g,d=function(a,b){for(a=String(a),b=b||2;a.length<b;)a="0"+a;return a};return function(e,f,g){var h=A;if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(e)||/\d/.test(e)||(f=e,e=void 0),e=e?new Date(e):new Date,isNaN(e))throw SyntaxError("invalid date");f=String(h.masks[f]||f||h.masks["default"]),"UTC:"==f.slice(0,4)&&(f=f.slice(4),g=!0);var i=g?"getUTC":"get",j=e[i+"Date"](),k=e[i+"Day"](),l=e[i+"Month"](),m=e[i+"FullYear"](),n=e[i+"Hours"](),o=e[i+"Minutes"](),p=e[i+"Seconds"](),q=e[i+"Milliseconds"](),r=g?0:e.getTimezoneOffset(),s={d:j,dd:d(j),ddd:h.i18n.dayNames[k],dddd:h.i18n.dayNames[k+7],m:l+1,mm:d(l+1),mmm:h.i18n.monthNames[l],mmmm:h.i18n.monthNames[l+12],yy:String(m).slice(2),yyyy:m,h:n%12||12,hh:d(n%12||12),H:n,HH:d(n),M:o,MM:d(o),s:p,ss:d(p),l:d(q,3),L:d(q>99?Math.round(q/10):q),t:n<12?"a":"p",tt:n<12?"am":"pm",T:n<12?"A":"P",TT:n<12?"AM":"PM",Z:g?"UTC":(String(e).match(b)||[""]).pop().replace(c,""),o:(r>0?"-":"+")+d(100*Math.floor(Math.abs(r)/60)+Math.abs(r)%60,4),S:["th","st","nd","rd"][j%10>3?0:(j%100-j%10!=10)*j%10]};return f.replace(a,function(a){return a in s?s[a]:a.slice(1,a.length-1)})}}();A.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},A.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},Date.prototype.format=function(a,b){return A(this,a,b)}}]).constant("uibdatepickerPopupConfig",{datepickerPopup:"dd/MM/yyyy",closeOnDateSelection:!0,appendToBody:!0,showButtonBar:!1}).constant("uibDatepickerConfig",{formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",datepickerMode:"day",minMode:"day",maxMode:"year",showWeeks:!1,startingDay:0,yearRange:20,minDate:null,maxDate:new Date}),userApp.filter("trusted",["$sce",function(a){return function(b){return a.trustAsResourceUrl(b)}}]),userApp.directive("historyGraph",function(){return{restrict:"C",replace:!0,scope:{historygraph:"="},controller:function(a,b,c){},template:'<div id="graph-container" style="height: 400px;width: 67%">not working</div>',link:function(a,b,c){var d=new Highcharts.Chart({chart:{renderTo:"graph-container",plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1},title:{text:a.test,x:-20},subtitle:{text:"",x:-20},xAxis:{title:{text:"Date Range"},categories:[]},yAxis:{title:{text:"Weight (Kgs)"},plotLines:[{value:0,width:1,color:"#ff0066"}]},tooltip:{valueSuffix:"Kgs"},colors:["#ff0066"],legend:{layout:"vertical",align:"right",verticalAlign:"middle",borderWidth:0,x:80,y:0},series:[{name:"Weight",data:[]}],exporting:{enabled:!1},credits:{enabled:!1}});a.$watch("historygraph",function(a){d.series[0].setData(a,!0)},!0)}}}),userApp.directive("heightFoodBind",function(){return{link:function(a,b){a.$watch(function(){setTimeout(function(){var a=$(".food");b.height()>parseInt($(".food_scrollbar").css("height"))?a.css({paddingRight:"15px"}):a.css({paddingRight:"3px"})},500)})}}}),userApp.directive("heightExerciseBind",function(){return{link:function(a,b){a.$watch(function(){setTimeout(function(){var a=$(".exercise");b.height()>parseInt($(".exercise-height").css("height"))?a.css({paddingRight:"15px"}):a.css({paddingRight:"3px"})},500)})}}}),userApp.directive("shouldFocus",function(){return{restrict:"A",link:function(a,b,c){a.$watch(c.shouldFocus,function(a,c){a&&b[0].scrollIntoView(!1)})}}});
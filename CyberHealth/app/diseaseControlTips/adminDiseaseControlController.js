var adminApp=angular.module("adminApp",["ngRoute","oc.lazyLoad","requestModule","flash","ngAnimate","summernote","angularUtils.directives.dirPagination"]);adminApp.controller("DiseaseControlController",["$scope","requestHandler","Flash","$location","siteMenuService",function(a,b,c,d,e){a.isNew=!0,a.title="Add CDC",a.siteMenuList=e,$.each(a.siteMenuList,function(a,b){b.href==d.path().substr(1)?b.active="active":b.active=""}),a.imageAdded=!1,a.fileNameChanged=function(b){a.imageAdded||(b.files.length>0?(a.inputContainsFile=!1,a.imageAdded=!0):(a.inputContainsFile=!0,a.imageAdded=!1))},a.options={height:250},a.imageUpload=!1,a.doUpdateImage=function(){a.imageUpload=!0},a.doGetHealthyListByAdmin=function(){a.loaded=!0,b.getRequest("admin/getHealthyLivingList/","").then(function(b){a.adminhealthytips=b.data.healthyliving,a.loaded=!1,a.paginationLoad=!0},function(){errorMessage(c,"Please try again later!")})},a.doEnableDisableHealthyTips=function(d){b.postRequest("admin/enableordisableHealthyLiving/",{syndicateid:d}).then(function(b){a.doGetHealthyListByAdmin(),successMessage(c,"Successfully Updated")},function(){errorMessage(c,"Please try again later!")})},a.doAddHealthyTips=function(){a.imageUpload?a.healthyliving.imageurl=$(".image-editor").cropit("export"):delete a.healthyliving.imageurl,b.postRequest("admin/insertorupdateHealthyLiving/",a.healthyliving).then(function(a){successMessage(c,"Successfully Added"),d.path("cdc-list")},function(){errorMessage(c,"Please try again later!")})},a.deleteHealthyTips=function(d){var e=confirm("Are you sure you want to delete the Content?");1==e&&b.postRequest("admin/deleteHealthyLiving/",{syndicateid:d}).then(function(b){a.doGetHealthyListByAdmin(),successMessage(c,"Successfully Deleted")},function(){errorMessage(c,"Please try again later!")})},a.init=function(){a.paginationLoad=!1,a.doGetHealthyListByAdmin()},$(".image-editor").cropit()}]),adminApp.controller("DiseaseControlEditController",["$scope","requestHandler","Flash","$location","$routeParams","$sce","siteMenuService",function(a,b,c,d,e,f,g){a.isNew=!1,a.siteMenuList=g,$.each(a.siteMenuList,function(a,b){b.href==d.path().substr(1)?b.active="active":b.active=""}),a.title="Edit CDC",a.options={height:250};a.doGetHealthyTipsAdminByID=function(){b.getRequest("admin/getHealthyLivingListById/"+e.sid,"").then(function(b){a.myImgSrc=f.trustAsResourceUrl(b.data.healthyliving.imageurl+"?decache="+Math.random()),a.healthyliving=b.data.healthyliving,$(".image-editor").cropit({imageState:{src:a.healthyliving.imageurl+"?decache="+Math.random()}})},function(){errorMessage(c,"Please try again later!")})},a.imageAdded=!1,a.fileNameChanged=function(b){a.imageAdded||(b.files.length>0?(a.inputContainsFile=!1,a.imageAdded=!0):(a.inputContainsFile=!0,a.imageAdded=!1))},a.convertImgToBase64=function(a,b,c){var d=new Image;d.crossOrigin="Anonymous",d.onload=function(){var a=document.createElement("CANVAS"),d=a.getContext("2d");a.height=this.height,a.width=this.width,d.drawImage(this,0,0);var e=a.toDataURL(c||"image/jpg");b(e),a=null},d.src=a},a.imageUpload=!1,a.doUpdateImage=function(){a.imageUpload=!0},a.doUpdateHealthyTips=function(){a.imageUpload?(a.healthyliving.imageurl=$(".image-editor").cropit("export"),a.convertImgToBase64(a.healthyliving.imageurl,function(b){a.healthyliving.imageurl=b,console.log(b)})):delete a.healthyliving.imageurl,b.putRequest("admin/insertorupdateHealthyLiving/",a.healthyliving).then(function(a){successMessage(c,"Successfully Updated"),d.path("cdc-list")},function(){errorMessage(c,"Please try again later!")})},a.doGetHealthyTipsAdminByID()}]),adminApp.filter("html",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]),adminApp.directive("validFile",function(){return{require:"ngModel",link:function(a,b,c,d){b.bind("change",function(){a.$apply(function(){d.$setViewValue(b.val()),d.$render()})})}}}),adminApp.directive("calendar",function(){return{require:"ngModel",link:function(a,b,c,d){$(b).datepicker({dateFormat:"dd/mm/yy",maxDate:new Date,onSelect:function(b){a.$apply(function(){d.$setViewValue(b)})}})}}});
var adminApp=angular.module("adminApp",["ngRoute","oc.lazyLoad","requestModule","flash","ngAnimate","summernote","angularUtils.directives.dirPagination"]);adminApp.controller("TestimonialController",["$scope","requestHandler","Flash","$location","siteMenuService",function(a,b,c,d,e){a.isNew=!0,a.title="Add Testimonial",a.siteMenuList=e,$.each(a.siteMenuList,function(a,b){3==b.id?b.active="active":b.active=""}),a.imageAdded=!1,a.fileNameChanged=function(b){a.imageAdded||(b.files.length>0?(a.inputContainsFile=!1,a.imageAdded=!0):(a.inputContainsFile=!0,a.imageAdded=!1))},a.imageUpload=!1,a.doUpdateImage=function(){a.imageUpload=!0},a.options={height:200},a.doGetTestimonialsByAdmin=function(){a.loaded=!0,b.getRequest("admin/getTestimonialList/","").then(function(b){a.admintestimonials=b.data.Testimonials,a.loaded=!1,a.paginationLoad=!0},function(){errorMessage(c,"Please try again later!")})},a.doAddTestimonials=function(){a.imageUpload?a.testimonials.imageurl=document.getElementById("base64").value:delete a.testimonials.imageurl,console.log(a.testimonials.imageurl),b.postRequest("admin/insertorupdateTestimonial/",a.testimonials).then(function(a){successMessage(c,"Successfully Added"),d.path("testimonials")},function(){errorMessage(c,"Please try again later!")})},a.doEnableDisableTestimonials=function(d){b.postRequest("admin/enableordisableTestimonial/",{testimonialid:d}).then(function(b){a.doGetTestimonialsByAdmin(),successMessage(c,"Successfully Updated")},function(){errorMessage(c,"Please try again later!")})},a.init=function(){a.paginationLoad=!1,a.doGetTestimonialsByAdmin()},$(".image-editor").cropit()}]),adminApp.controller("TestimonialEditController",["$scope","requestHandler","Flash","$location","$routeParams","$sce","siteMenuService",function(a,b,c,d,e,f,g){a.siteMenuList=g,$.each(a.siteMenuList,function(a,b){3==b.id?b.active="active":b.active=""}),a.options={height:200},a.imageAdded=!1,a.fileNameChanged=function(b){a.imageAdded||(b.files.length>0?(a.inputContainsFile=!1,a.imageAdded=!0):(a.inputContainsFile=!0,a.imageAdded=!1))};a.doGetTestimonialsAdminByID=function(){a.isNew=!1,a.title="Edit Testimonial",b.getRequest("admin/getTestimonialListById/"+e.id,"").then(function(b){delete b.data.Testimonials.datetime,a.myImgSrc=f.trustAsResourceUrl(b.data.Testimonials.imageurl+"?decache="+Math.random()),a.testimonials=b.data.Testimonials,a.originalTestimonial=angular.copy(b.data.Testimonials),$(".image-editor").cropit({imageState:{src:a.testimonials.imageurl+"?decache="+Math.random()}})},function(){errorMessage(c,"Please try again later!")})},a.convertImgToBase64=function(a,b,c){var d=new Image;d.crossOrigin="Anonymous",d.onload=function(){var a=document.createElement("CANVAS"),d=a.getContext("2d");a.height=this.height,a.width=this.width,d.drawImage(this,0,0);var e=a.toDataURL(c||"image/jpg");b(e),a=null},d.src=a},a.imageUpload=!1,a.doUpdateImage=function(){a.imageUpload=!0},a.doUpdateTestimonials=function(){a.imageUpload?(a.testimonials.imageurl=$(".image-editor").cropit("export"),a.convertImgToBase64(a.testimonials.imageurl,function(b){a.testimonials.imageurl=b})):delete a.testimonials.imageurl,b.putRequest("admin/insertorupdateTestimonial/",a.testimonials).then(function(a){successMessage(c,"Successfully Updated"),d.path("testimonials")},function(){errorMessage(c,"Please try again later!")})},a.isCleanTestimonial=function(){return angular.equals(a.originalTestimonial,a.testimonials)},a.doGetTestimonialsAdminByID()}]),adminApp.filter("html",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]),adminApp.directive("validFile",function(){return{require:"ngModel",link:function(a,b,c,d){b.bind("change",function(){a.$apply(function(){d.$setViewValue(b.val()),d.$render()})})}}});var commonApp=angular.module("commonApp",["ngRoute","oc.lazyLoad","requestModule","flash","ngAnimate"]);commonApp.controller("TestimonialUserController",["$scope","requestHandler","Flash","$sce","$routeParams",function(a,b,c,d,e){a.doGetTestimonialsByUser=function(){b.getRequest("getTestimonialListByUser/","").then(function(b){a.usertestimoniallist=b.data.Testimonials,a.myImgSrc=d.trustAsResourceUrl(b.data.Testimonials[0].imageurl+"?decache="+Math.random()),a.usertestimonialdetails=b.data.Testimonials[0]},function(){errorMessage(c,"Please try again later!")})},a.doGetTestimonialDetailsByUser=function(e){return b.getRequest("getTestimonialDetail/"+e,"").then(function(b){a.myImgSrc=d.trustAsResourceUrl(b.data.Testimonials.imageurl+"?decache="+Math.random()),a.usertestimonialdetails=b.data.Testimonials},function(){errorMessage(c,"Please try again later!")}),!1},a.doGetTestimonialsByUser(),a.doGetTestimonialDetailsByUser(e.id)}]),commonApp.filter("trusted",["$sce",function(a){return function(b){return a.trustAsResourceUrl(b)}}]),commonApp.filter("html",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]);
var adminApp=angular.module("adminApp",["ngRoute","oc.lazyLoad","requestModule","flash","ngAnimate","summernote","angularUtils.directives.dirPagination"]);adminApp.controller("TestimonialController",["$scope","requestHandler","Flash","$location","siteMenuService",function(e,t,i,n,a){e.isNew=!0,e.title="Add Testimonial",e.siteMenuList=a,$.each(e.siteMenuList,function(e,t){3==t.id?t.active="active":t.active=""}),e.imageAdded=!1,e.fileNameChanged=function(t){e.imageAdded||(t.files.length>0?(e.inputContainsFile=!1,e.imageAdded=!0):(e.inputContainsFile=!0,e.imageAdded=!1))},e.options={height:200},e.doGetTestimonialsByAdmin=function(){e.loaded=!0,t.getRequest("admin/getTestimonialList/","").then(function(t){e.admintestimonials=t.data.Testimonials,e.loaded=!1,e.paginationLoad=!0},function(){errorMessage(i,"Please try again later!")})},e.doAddTestimonials=function(){e.testimonials.imageurl=$(".image-editor").cropit("export"),t.postRequest("admin/insertorupdateTestimonial/",e.testimonials).then(function(){successMessage(i,"Successfully Added"),n.path("testimonials")},function(){errorMessage(i,"Please try again later!")})},e.doEnableDisableTestimonials=function(n){t.postRequest("admin/enableordisableTestimonial/",{testimonialid:n}).then(function(){e.doGetTestimonialsByAdmin(),successMessage(i,"Successfully Updated")},function(){errorMessage(i,"Please try again later!")})},e.init=function(){e.paginationLoad=!1,e.doGetTestimonialsByAdmin()},$(".image-editor").cropit()}]),adminApp.controller("TestimonialEditController",["$scope","requestHandler","Flash","$location","$routeParams","$sce","siteMenuService",function(e,t,i,n,a,s,o){e.siteMenuList=o,$.each(e.siteMenuList,function(e,t){3==t.id?t.active="active":t.active=""}),e.options={height:200},e.imageAdded=!1,e.fileNameChanged=function(t){e.imageAdded||(t.files.length>0?(e.inputContainsFile=!1,e.imageAdded=!0):(e.inputContainsFile=!0,e.imageAdded=!1))};e.doGetTestimonialsAdminByID=function(){e.isNew=!1,e.title="Edit Testimonial",t.getRequest("admin/getTestimonialListById/"+a.id,"").then(function(t){delete t.data.Testimonials.datetime,e.myImgSrc=s.trustAsResourceUrl(t.data.Testimonials.imageurl+"?decache="+Math.random()),e.testimonials=t.data.Testimonials,$(".image-editor").cropit({imageState:{src:e.testimonials.imageurl+"?decache="+Math.random()}})},function(){errorMessage(i,"Please try again later!")})},e.convertImgToBase64=function(e,t,i){var n=new Image;n.crossOrigin="Anonymous",n.onload=function(){var e=document.createElement("CANVAS"),n=e.getContext("2d");e.height=this.height,e.width=this.width,n.drawImage(this,0,0);var a=e.toDataURL(i||"image/jpg");t(a),e=null},n.src=e},e.doUpdateTestimonials=function(){e.convertImgToBase64(e.testimonials.imageurl,function(a){e.testimonials.imageurl=a,e.testimonials.imageurl=$(".image-editor").cropit("export"),t.putRequest("admin/insertorupdateTestimonial/",e.testimonials).then(function(){successMessage(i,"Successfully Updated"),n.path("testimonials")},function(){errorMessage(i,"Please try again later!")})})},e.doGetTestimonialsAdminByID()}]),adminApp.filter("html",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]),adminApp.directive("validFile",function(){return{require:"ngModel",link:function(e,t,i,n){t.bind("change",function(){e.$apply(function(){n.$setViewValue(t.val()),n.$render()})})}}});var commonApp=angular.module("commonApp",["ngRoute","oc.lazyLoad","requestModule","flash","ngAnimate"]);commonApp.controller("TestimonialUserController",["$scope","requestHandler","Flash","$sce","$routeParams",function(e,t,i,n,a){e.doGetTestimonialsByUser=function(){t.getRequest("getTestimonialListByUser/","").then(function(t){e.usertestimoniallist=t.data.Testimonials,e.myImgSrc=n.trustAsResourceUrl(t.data.Testimonials[0].imageurl+"?decache="+Math.random()),e.usertestimonialdetails=t.data.Testimonials[0]},function(){errorMessage(i,"Please try again later!")})},e.doGetTestimonialDetailsByUser=function(a){return t.getRequest("getTestimonialDetail/"+a,"").then(function(t){e.myImgSrc=n.trustAsResourceUrl(t.data.Testimonials.imageurl+"?decache="+Math.random()),e.usertestimonialdetails=t.data.Testimonials},function(){errorMessage(i,"Please try again later!")}),!1},e.doGetTestimonialsByUser(),e.doGetTestimonialDetailsByUser(a.id)}]),commonApp.filter("trusted",["$sce",function(e){return function(t){return e.trustAsResourceUrl(t)}}]),commonApp.filter("html",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]);